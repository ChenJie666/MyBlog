<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Sqoop源码 | Hexo</title><meta name="author" content="CJ"><meta name="copyright" content="CJ"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一、源码概览查看sqoop脚本的命令，发现最终会调用org.apache.sqoop.Sqoop类来运行任务。 1exec $&amp;#123;HADOOP_COMMON_HOME&amp;#125;&#x2F;bin&#x2F;hadoop org.apache.sqoop.Sqoop &quot;$@&quot;  org.apache.sqoop.Sqoop的main方法如下 123456789101112131415161">
<meta property="og:type" content="article">
<meta property="og:title" content="Sqoop源码">
<meta property="og:url" content="http://example.com/2023/05/06/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%A6%BB%E7%BA%BF/Sqoop%E6%BA%90%E7%A0%81/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="一、源码概览查看sqoop脚本的命令，发现最终会调用org.apache.sqoop.Sqoop类来运行任务。 1exec $&amp;#123;HADOOP_COMMON_HOME&amp;#125;&#x2F;bin&#x2F;hadoop org.apache.sqoop.Sqoop &quot;$@&quot;  org.apache.sqoop.Sqoop的main方法如下 123456789101112131415161">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2023-05-06T05:31:21.059Z">
<meta property="article:modified_time" content="2023-05-06T05:31:21.059Z">
<meta property="article:author" content="CJ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/05/06/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%A6%BB%E7%BA%BF/Sqoop%E6%BA%90%E7%A0%81/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Sqoop源码',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-05-06 13:31:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">419</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">38</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Hexo"><span class="site-name">Hexo</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Sqoop源码</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-05-06T05:31:21.059Z" title="发表于 2023-05-06 13:31:21">2023-05-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-05-06T05:31:21.059Z" title="更新于 2023-05-06 13:31:21">2023-05-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%A6%BB%E7%BA%BF/">大数据离线</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Sqoop源码"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="一、源码概览"><a href="#一、源码概览" class="headerlink" title="一、源码概览"></a>一、源码概览</h1><p>查看sqoop脚本的命令，发现最终会调用org.apache.sqoop.Sqoop类来运行任务。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec $&#123;HADOOP_COMMON_HOME&#125;/bin/hadoop org.apache.sqoop.Sqoop &quot;$@&quot;</span><br></pre></td></tr></table></figure>

<p>org.apache.sqoop.Sqoop的main方法如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String [] args) &#123;</span><br><span class="line">  if (args.length == 0) &#123;</span><br><span class="line">    System.err.println(&quot;Try &#x27;sqoop help&#x27; for usage.&quot;);</span><br><span class="line">    System.exit(1);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  int ret = runTool(args);</span><br><span class="line">  System.exit(ret);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static int runTool(String [] args) &#123;</span><br><span class="line">  return runTool(args, new Configuration());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static int runTool(String [] args, Configuration conf) &#123;</span><br><span class="line">  // Expand the options</span><br><span class="line">  String[] expandedArgs = null;</span><br><span class="line">  try &#123;</span><br><span class="line">    expandedArgs = OptionsFileUtil.expandArguments(args);</span><br><span class="line">  &#125; catch (Exception ex) &#123;</span><br><span class="line">    LOG.error(&quot;Error while expanding arguments&quot;, ex);</span><br><span class="line">    System.err.println(ex.getMessage());</span><br><span class="line">    System.err.println(&quot;Try &#x27;sqoop help&#x27; for usage.&quot;);</span><br><span class="line">    return 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  String toolName = expandedArgs[0];</span><br><span class="line">  Configuration pluginConf = SqoopTool.loadPlugins(conf);</span><br><span class="line">  SqoopTool tool = SqoopTool.getTool(toolName);</span><br><span class="line">  if (null == tool) &#123;</span><br><span class="line">    System.err.println(&quot;No such sqoop tool: &quot; + toolName</span><br><span class="line">        + &quot;. See &#x27;sqoop help&#x27;.&quot;);</span><br><span class="line">    return 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Sqoop sqoop = new Sqoop(tool, pluginConf);</span><br><span class="line">  return runSqoop(sqoop, Arrays.copyOfRange(expandedArgs, 1, expandedArgs.length));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果参数为0，直接退出。否则对参数进行解析并写入到options中，如果参数是options-file，则读取文件并将文件中的配置写入到options中。参数处理如下:<br>org.apache.sqoop.util.OptionsFileUtil</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">public static String[] expandArguments(String[] args) throws Exception &#123;</span><br><span class="line">  List&lt;String&gt; options = new ArrayList&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">  for (int i = 0; i &lt; args.length; i++) &#123;</span><br><span class="line">    if (args[i].equals(Sqoop.SQOOP_OPTIONS_FILE_SPECIFIER)) &#123;</span><br><span class="line">      if (i == args.length - 1) &#123;</span><br><span class="line">        throw new Exception(&quot;Missing options file&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      String fileName = args[++i];</span><br><span class="line">      File optionsFile = new File(fileName);</span><br><span class="line">      BufferedReader reader = null;</span><br><span class="line">      StringBuilder buffer = new StringBuilder();</span><br><span class="line">      try &#123;</span><br><span class="line">        reader = new BufferedReader(new FileReader(optionsFile));</span><br><span class="line">        String nextLine = null;</span><br><span class="line">        while ((nextLine = reader.readLine()) != null) &#123;</span><br><span class="line">          nextLine = nextLine.trim();</span><br><span class="line">          if (nextLine.length() == 0 || nextLine.startsWith(&quot;#&quot;)) &#123;</span><br><span class="line">            // empty line or comment</span><br><span class="line">            continue;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          buffer.append(nextLine);</span><br><span class="line">          if (nextLine.endsWith(&quot;\&quot;)) &#123;</span><br><span class="line">            if (buffer.charAt(0) == &#x27;\&#x27;&#x27; || buffer.charAt(0) == &#x27;&quot;&#x27;) &#123;</span><br><span class="line">              throw new Exception(</span><br><span class="line">                  &quot;Multiline quoted strings not supported in file(&quot;</span><br><span class="line">                    + fileName + &quot;): &quot; + buffer.toString());</span><br><span class="line">            &#125;</span><br><span class="line">            // Remove the trailing back-slash and continue</span><br><span class="line">            buffer.deleteCharAt(buffer.length()  - 1);</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            // The buffer contains a full option</span><br><span class="line">            options.add(</span><br><span class="line">                removeQuotesEncolosingOption(fileName, buffer.toString()));</span><br><span class="line">            buffer.delete(0, buffer.length());</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Assert that the buffer is empty</span><br><span class="line">        if (buffer.length() != 0) &#123;</span><br><span class="line">          throw new Exception(&quot;Malformed option in options file(&quot;</span><br><span class="line">              + fileName + &quot;): &quot; + buffer.toString());</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; catch (IOException ex) &#123;</span><br><span class="line">        throw new Exception(&quot;Unable to read options file: &quot; + fileName, ex);</span><br><span class="line">      &#125; finally &#123;</span><br><span class="line">        if (reader != null) &#123;</span><br><span class="line">          try &#123;</span><br><span class="line">            reader.close();</span><br><span class="line">          &#125; catch (IOException ex) &#123;</span><br><span class="line">            LOG.info(&quot;Exception while closing reader&quot;, ex);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      // Regular option. Parse it and put it on the appropriate list</span><br><span class="line">      options.add(args[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>获取所有参数后，取第一个参数，这个参数指定了使用的SqoopTool。框架已经为了我准备了大量的SqoopTool用于数据在不同数据库间流转。<br>org.apache.sqoop.tool.SqoopTool</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">static &#123;</span><br><span class="line">  // All SqoopTool instances should be registered here so that</span><br><span class="line">  // they can be found internally.</span><br><span class="line">  TOOLS = new TreeMap&lt;String, Class&lt;? extends SqoopTool&gt;&gt;();</span><br><span class="line">  DESCRIPTIONS = new TreeMap&lt;String, String&gt;();</span><br><span class="line"></span><br><span class="line">  registerTool(&quot;codegen&quot;, CodeGenTool.class,</span><br><span class="line">      &quot;Generate code to interact with database records&quot;);</span><br><span class="line">  registerTool(&quot;create-hive-table&quot;, CreateHiveTableTool.class,</span><br><span class="line">      &quot;Import a table definition into Hive&quot;);</span><br><span class="line">  registerTool(&quot;eval&quot;, EvalSqlTool.class,</span><br><span class="line">      &quot;Evaluate a SQL statement and display the results&quot;);</span><br><span class="line">  registerTool(&quot;export&quot;, ExportTool.class,</span><br><span class="line">      &quot;Export an HDFS directory to a database table&quot;);</span><br><span class="line">  registerTool(&quot;import&quot;, ImportTool.class,</span><br><span class="line">      &quot;Import a table from a database to HDFS&quot;);</span><br><span class="line">  registerTool(&quot;import-all-tables&quot;, ImportAllTablesTool.class,</span><br><span class="line">      &quot;Import tables from a database to HDFS&quot;);</span><br><span class="line">  registerTool(&quot;import-mainframe&quot;, MainframeImportTool.class,</span><br><span class="line">          &quot;Import datasets from a mainframe server to HDFS&quot;);</span><br><span class="line">  registerTool(&quot;help&quot;, HelpTool.class, &quot;List available commands&quot;);</span><br><span class="line">  registerTool(&quot;list-databases&quot;, ListDatabasesTool.class,</span><br><span class="line">      &quot;List available databases on a server&quot;);</span><br><span class="line">  registerTool(&quot;list-tables&quot;, ListTablesTool.class,</span><br><span class="line">      &quot;List available tables in a database&quot;);</span><br><span class="line">  registerTool(&quot;merge&quot;, MergeTool.class,</span><br><span class="line">      &quot;Merge results of incremental imports&quot;);</span><br><span class="line">  registerTool(&quot;metastore&quot;, MetastoreTool.class,</span><br><span class="line">      &quot;Run a standalone Sqoop metastore&quot;);</span><br><span class="line">  registerTool(&quot;job&quot;, JobTool.class,</span><br><span class="line">      &quot;Work with saved jobs&quot;);</span><br><span class="line">  registerTool(&quot;version&quot;, VersionTool.class,</span><br><span class="line">      &quot;Display version information&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果找到SqoopTool，则执行runSqoop</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public static int runSqoop(Sqoop sqoop, String [] args) &#123;</span><br><span class="line">  try &#123;</span><br><span class="line">    String [] toolArgs = sqoop.stashChildPrgmArgs(args);</span><br><span class="line">    return ToolRunner.run(sqoop.getConf(), sqoop, toolArgs);</span><br><span class="line">  &#125; catch (Exception e) &#123;</span><br><span class="line">    LOG.error(&quot;Got exception running Sqoop: &quot; + e.toString());</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">    if (System.getProperty(SQOOP_RETHROW_PROPERTY) != null) &#123;</span><br><span class="line">      throw new RuntimeException(e);</span><br><span class="line">    &#125;</span><br><span class="line">    return 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里执行ToolRunner.run()方法<br>org.apache.hadoop.util.ToolRunner</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public static int run(Configuration conf, Tool tool, String[] args) throws Exception &#123;</span><br><span class="line">    if (conf == null) &#123;</span><br><span class="line">        conf = new Configuration();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    GenericOptionsParser parser = new GenericOptionsParser(conf, args);</span><br><span class="line">    tool.setConf(conf);</span><br><span class="line">    String[] toolArgs = parser.getRemainingArgs();</span><br><span class="line">    return tool.run(toolArgs);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>虽然看起来是执行的hadoop包中的run方法，但是最终还是执行的Sqoop.run()方法。<br>org.apache.sqoop.Sqoop</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public int run(String [] args) &#123;</span><br><span class="line">  if (options.getConf() == null) &#123;</span><br><span class="line">    // Configuration wasn&#x27;t initialized until after the ToolRunner</span><br><span class="line">    // got us to this point. ToolRunner gave Sqoop itself a Conf</span><br><span class="line">    // though.</span><br><span class="line">    options.setConf(getConf());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line">    options = tool.parseArguments(args, null, options, false);</span><br><span class="line">    tool.appendArgs(this.childPrgmArgs);</span><br><span class="line">    tool.validateOptions(options);</span><br><span class="line">  &#125; catch (Exception e) &#123;</span><br><span class="line">    // Couldn&#x27;t parse arguments.</span><br><span class="line">    // Log the stack trace for this exception</span><br><span class="line">    LOG.debug(e.getMessage(), e);</span><br><span class="line">    // Print exception message.</span><br><span class="line">    System.err.println(e.getMessage());</span><br><span class="line">    return 1; // Exit on exception here.</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return tool.run(options);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>parseArguments方法对参数进行解析。<br>org.apache.sqoop.tool.SqoopTool类</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">public SqoopOptions parseArguments(String [] args,</span><br><span class="line">    Configuration conf, SqoopOptions in, boolean useGenericOptions)</span><br><span class="line">    throws ParseException, SqoopOptions.InvalidOptionsException &#123;</span><br><span class="line">  SqoopOptions out = in;</span><br><span class="line"></span><br><span class="line">  if (null == out) &#123;</span><br><span class="line">    out = new SqoopOptions();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (null != conf) &#123;</span><br><span class="line">    // User specified a configuration; use it and override any conf</span><br><span class="line">    // that may have been in the SqoopOptions.</span><br><span class="line">    out.setConf(conf);</span><br><span class="line">  &#125; else if (null == out.getConf()) &#123;</span><br><span class="line">    // User did not specify a configuration, but neither did the</span><br><span class="line">    // SqoopOptions. Fabricate a new one.</span><br><span class="line">    out.setConf(new Configuration());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // This tool is the &quot;active&quot; tool; bind it in the SqoopOptions.</span><br><span class="line">  //TODO(jarcec): Remove the cast when SqoopOptions will be moved</span><br><span class="line">  //              to apache package</span><br><span class="line">  out.setActiveSqoopTool((com.cloudera.sqoop.tool.SqoopTool)this);</span><br><span class="line"></span><br><span class="line">  String [] toolArgs = args; // args after generic parser is done.</span><br><span class="line">  if (useGenericOptions) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      toolArgs = ConfigurationHelper.parseGenericOptions(</span><br><span class="line">          out.getConf(), args);</span><br><span class="line">    &#125; catch (IOException ioe) &#123;</span><br><span class="line">      ParseException pe = new ParseException(</span><br><span class="line">          &quot;Could not parse generic arguments&quot;);</span><br><span class="line">      pe.initCause(ioe);</span><br><span class="line">      throw pe;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // Parse tool-specific arguments.</span><br><span class="line">  ToolOptions toolOptions = new ToolOptions();</span><br><span class="line">  configureOptions(toolOptions);</span><br><span class="line">  CommandLineParser parser = new SqoopParser();</span><br><span class="line">  CommandLine cmdLine = parser.parse(toolOptions.merge(), toolArgs, true);</span><br><span class="line">  applyOptions(cmdLine, out);</span><br><span class="line">  this.extraArguments = cmdLine.getArgs();</span><br><span class="line">  return out;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>真正的参数解析是在SqoopParser这个类的parse方法中。<br>org.apache.commons.cli.Parser类</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">public CommandLine parse(Options options, String[] arguments, Properties properties, boolean stopAtNonOption) throws ParseException &#123;</span><br><span class="line">    Iterator it = options.helpOptions().iterator();</span><br><span class="line"></span><br><span class="line">    while(it.hasNext()) &#123;</span><br><span class="line">        Option opt = (Option)it.next();</span><br><span class="line">        opt.clearValues();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    this.setOptions(options);</span><br><span class="line">    this.cmd = new CommandLine();</span><br><span class="line">    boolean eatTheRest = false;</span><br><span class="line">    if (arguments == null) &#123;</span><br><span class="line">        arguments = new String[0];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List tokenList = Arrays.asList(this.flatten(this.getOptions(), arguments, stopAtNonOption));</span><br><span class="line">    ListIterator iterator = tokenList.listIterator();</span><br><span class="line"></span><br><span class="line">    while(true) &#123;</span><br><span class="line">        do &#123;</span><br><span class="line">            if (!iterator.hasNext()) &#123;</span><br><span class="line">                this.processProperties(properties);</span><br><span class="line">                this.checkRequiredOptions();</span><br><span class="line">                return this.cmd;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            String t = (String)iterator.next();</span><br><span class="line">            if (&quot;--&quot;.equals(t)) &#123;</span><br><span class="line">                eatTheRest = true;</span><br><span class="line">            &#125; else if (&quot;-&quot;.equals(t)) &#123;</span><br><span class="line">                if (stopAtNonOption) &#123;</span><br><span class="line">                    eatTheRest = true;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    this.cmd.addArg(t);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else if (t.startsWith(&quot;-&quot;)) &#123;</span><br><span class="line">                if (stopAtNonOption &amp;&amp; !this.getOptions().hasOption(t)) &#123;</span><br><span class="line">                    eatTheRest = true;</span><br><span class="line">                    this.cmd.addArg(t);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    this.processOption(t, iterator);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                this.cmd.addArg(t);</span><br><span class="line">                if (stopAtNonOption) &#123;</span><br><span class="line">                    eatTheRest = true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; while(!eatTheRest);</span><br><span class="line"></span><br><span class="line">        while(iterator.hasNext()) &#123;</span><br><span class="line">            String str = (String)iterator.next();</span><br><span class="line">            if (!&quot;--&quot;.equals(str)) &#123;</span><br><span class="line">                this.cmd.addArg(str);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该方法中，将参数和参数的值依次插入到LinkedList中进行存储(使用-和–开头的参数和值都会进行存储)。</p>
<p>参数解析完成后执行run方法中的tool.run(options)方法，随着参数不同，选择的SqoopTool不同，会执行不同的代码。</p>
<p>当我们第一个参数是<strong>import</strong>时，那么使用的SqoopTool是<strong>ImportTool</strong>。<br>下面是ImportTool的run方法。<br>org.apache.sqoop.tool.ImportTool</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public int run(SqoopOptions options) &#123;</span><br><span class="line">  HiveImport hiveImport = null;</span><br><span class="line"></span><br><span class="line">  if (allTables) &#123;</span><br><span class="line">    // We got into this method, but we should be in a subclass.</span><br><span class="line">    // (This method only handles a single table)</span><br><span class="line">    // This should not be reached, but for sanity&#x27;s sake, test here.</span><br><span class="line">    LOG.error(&quot;ImportTool.run() can only handle a single table.&quot;);</span><br><span class="line">    return 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (!init(options)) &#123;</span><br><span class="line">    return 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  codeGenerator.setManager(manager);</span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line">    if (options.doHiveImport()) &#123;</span><br><span class="line">      hiveImport = new HiveImport(options, manager, options.getConf(), false);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Import a single table (or query) the user specified.</span><br><span class="line">    importTable(options, options.getTableName(), hiveImport);</span><br><span class="line">  &#125; catch (IllegalArgumentException iea) &#123;</span><br><span class="line">      LOG.error(&quot;Imported Failed: &quot; + iea.getMessage());</span><br><span class="line">      if (System.getProperty(Sqoop.SQOOP_RETHROW_PROPERTY) != null) &#123;</span><br><span class="line">        throw iea;</span><br><span class="line">      &#125;</span><br><span class="line">      return 1;</span><br><span class="line">  &#125; catch (IOException ioe) &#123;</span><br><span class="line">    LOG.error(&quot;Encountered IOException running import job: &quot;</span><br><span class="line">        + StringUtils.stringifyException(ioe));</span><br><span class="line">    if (System.getProperty(Sqoop.SQOOP_RETHROW_PROPERTY) != null) &#123;</span><br><span class="line">      throw new RuntimeException(ioe);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      return 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; catch (ImportException ie) &#123;</span><br><span class="line">    LOG.error(&quot;Error during import: &quot; + ie.toString());</span><br><span class="line">    if (System.getProperty(Sqoop.SQOOP_RETHROW_PROPERTY) != null) &#123;</span><br><span class="line">      throw new RuntimeException(ie);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      return 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; finally &#123;</span><br><span class="line">    destroy(options);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先看到执行了init方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected boolean init(SqoopOptions sqoopOpts) &#123;</span><br><span class="line">  boolean ret = super.init(sqoopOpts);</span><br><span class="line">  codeGenerator.setManager(manager);</span><br><span class="line">  return ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在run方法中执行init(options)时，会创建数据源管理器manager，具体创建过程如下<br>org.apache.sqoop.tool.BaseSqoopTool类</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">protected boolean init(SqoopOptions sqoopOpts) &#123;</span><br><span class="line">  // Get the connection to the database.</span><br><span class="line">  try &#123;</span><br><span class="line">    JobData data = new JobData(sqoopOpts, this);</span><br><span class="line">    this.manager = new ConnFactory(sqoopOpts.getConf()).getManager(data);</span><br><span class="line">    return true;</span><br><span class="line">  &#125; catch (Exception e) &#123;</span><br><span class="line">    LOG.error(&quot;Got error creating database manager: &quot;</span><br><span class="line">        + StringUtils.stringifyException(e));</span><br><span class="line">    if (System.getProperty(Sqoop.SQOOP_RETHROW_PROPERTY) != null) &#123;</span><br><span class="line">      throw new RuntimeException(e);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在run方法中执行init(options)时，会根据命令行参数，利用org.apache.sqoop.ConnFactory生成对应的ConnManager对象，管理各种数据库的访问。<br>org.apache.sqoop.ConnFactory类</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">public ConnManager getManager(JobData data) throws IOException &#123;</span><br><span class="line">  com.cloudera.sqoop.SqoopOptions options = data.getSqoopOptions();</span><br><span class="line">  String manualDriver = options.getDriverClassName();</span><br><span class="line">  String managerClassName = options.getConnManagerClassName();</span><br><span class="line"></span><br><span class="line">  // User has specified --driver argument, but he did not specified</span><br><span class="line">  // manager to use. We will use GenericJdbcManager as this was</span><br><span class="line">  // the way sqoop was working originally. However we will inform</span><br><span class="line">  // user that specifying connection manager explicitly is more cleaner</span><br><span class="line">  // solution for this case.</span><br><span class="line">  if (manualDriver != null &amp;&amp; managerClassName == null) &#123;</span><br><span class="line">    LOG.warn(&quot;Parameter --driver is set to an explicit driver however&quot;</span><br><span class="line">      + &quot; appropriate connection manager is not being set (via&quot;</span><br><span class="line">      + &quot; --connection-manager). Sqoop is going to fall back to &quot;</span><br><span class="line">      + GenericJdbcManager.class.getCanonicalName() + &quot;. Please specify&quot;</span><br><span class="line">      + &quot; explicitly which connection manager should be used next time.&quot;</span><br><span class="line">    );</span><br><span class="line">    return new GenericJdbcManager(manualDriver, options);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // If user specified explicit connection manager, let&#x27;s use it</span><br><span class="line">  if (managerClassName != null)&#123;</span><br><span class="line">    ConnManager connManager = null;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      Class&lt;ConnManager&gt; cls = (Class&lt;ConnManager&gt;)</span><br><span class="line">        Class.forName(managerClassName);</span><br><span class="line"></span><br><span class="line">      // We have two constructor options, one is with or without explicit</span><br><span class="line">      // constructor. In most cases --driver argument won&#x27;t be allowed as the</span><br><span class="line">      // connectors are forcing to use their building class names.</span><br><span class="line">      if (manualDriver == null) &#123;</span><br><span class="line">        Constructor&lt;ConnManager&gt; constructor =</span><br><span class="line">          cls.getDeclaredConstructor(com.cloudera.sqoop.SqoopOptions.class);</span><br><span class="line">        connManager = constructor.newInstance(options);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        Constructor&lt;ConnManager&gt; constructor =</span><br><span class="line">          cls.getDeclaredConstructor(String.class,</span><br><span class="line">                                     com.cloudera.sqoop.SqoopOptions.class);</span><br><span class="line">        connManager = constructor.newInstance(manualDriver, options);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">      LOG.error(&quot;Sqoop could not found specified connection manager class &quot;</span><br><span class="line">        + managerClassName  + &quot;. Please check that you&#x27;ve specified the &quot;</span><br><span class="line">        + &quot;class correctly.&quot;);</span><br><span class="line">      throw new IOException(e);</span><br><span class="line">    &#125; catch (NoSuchMethodException e) &#123;</span><br><span class="line">      LOG.error(&quot;Sqoop wasn&#x27;t able to create connnection manager properly. &quot;</span><br><span class="line">        + &quot;Some of the connectors supports explicit --driver and some &quot;</span><br><span class="line">        + &quot;do not. Please try to either specify --driver or leave it out.&quot;);</span><br><span class="line">      throw new IOException(e);</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">      LOG.error(&quot;Problem with bootstrapping connector manager:&quot;</span><br><span class="line">        + managerClassName);</span><br><span class="line">      LOG.error(e);</span><br><span class="line">      throw new IOException(e);</span><br><span class="line">    &#125;</span><br><span class="line">    return connManager;</span><br><span class="line">  &#125;</span><br><span class="line">  // Try all the available manager factories.</span><br><span class="line">  for (ManagerFactory factory : factories) &#123;</span><br><span class="line">    LOG.debug(&quot;Trying ManagerFactory: &quot; + factory.getClass().getName());</span><br><span class="line">    ConnManager mgr = factory.accept(data);</span><br><span class="line">    if (null != mgr) &#123;</span><br><span class="line">      LOG.debug(&quot;Instantiated ConnManager &quot; + mgr.toString());</span><br><span class="line">      return mgr;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  throw new IOException(&quot;No manager for connect string: &quot;</span><br><span class="line">      + data.getSqoopOptions().getConnectString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>init方法初始化数据库管理器之后，将其赋值给codeGenerator。接着执行importTable方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">protected boolean importTable(SqoopOptions options, String tableName,</span><br><span class="line">    HiveImport hiveImport) throws IOException, ImportException &#123;</span><br><span class="line">  String jarFile = null;</span><br><span class="line"></span><br><span class="line">  // Generate the ORM code for the tables.</span><br><span class="line">  jarFile = codeGenerator.generateORM(options, tableName);</span><br><span class="line"></span><br><span class="line">  Path outputPath = getOutputPath(options, tableName);</span><br><span class="line"></span><br><span class="line">  // Do the actual import.</span><br><span class="line">  ImportJobContext context = new ImportJobContext(tableName, jarFile,</span><br><span class="line">      options, outputPath);</span><br><span class="line"></span><br><span class="line">  // If we&#x27;re doing an incremental import, set up the</span><br><span class="line">  // filtering conditions used to get the latest records.</span><br><span class="line">  if (!initIncrementalConstraints(options, context)) &#123;</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (options.isDeleteMode()) &#123;</span><br><span class="line">    deleteTargetDir(context);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (null != tableName) &#123;</span><br><span class="line">    manager.importTable(context);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    manager.importQuery(context);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (options.isAppendMode()) &#123;</span><br><span class="line">    AppendUtils app = new AppendUtils(context);</span><br><span class="line">    app.append();</span><br><span class="line">  &#125; else if (options.getIncrementalMode() == SqoopOptions.IncrementalMode.DateLastModified) &#123;</span><br><span class="line">    lastModifiedMerge(options, context);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // If the user wants this table to be in Hive, perform that post-load.</span><br><span class="line">  if (options.doHiveImport()) &#123;</span><br><span class="line">    // For Parquet file, the import action will create hive table directly via</span><br><span class="line">    // kite. So there is no need to do hive import as a post step again.</span><br><span class="line">    if (options.getFileLayout() != SqoopOptions.FileLayout.ParquetFile) &#123;</span><br><span class="line">      hiveImport.importTable(tableName, options.getHiveTableName(), false);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  saveIncrementalState(options);</span><br><span class="line"></span><br><span class="line">  return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过 this.codeGenerator.generateORM(options, tableName); 来将表结构对应的 java 类写入 jar 文件，这个 jar 文件和其他 options 会构造出一个 ExportJobContext 对象，根据 –update_mode 参数来决定更新方式<br>org.apache.sqoop.tool.CodeGenTool类</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">public String generateORM(SqoopOptions options, String tableName)</span><br><span class="line">    throws IOException &#123;</span><br><span class="line">  String existingJar = options.getExistingJarName();</span><br><span class="line">  if (existingJar != null) &#123;</span><br><span class="line">    // This code generator is being invoked as part of an import or export</span><br><span class="line">    // process, and the user has pre-specified a jar and class to use.</span><br><span class="line">    // Don&#x27;t generate.</span><br><span class="line">    if (manager.isORMFacilitySelfManaged()) &#123;</span><br><span class="line">      // No need to generated any ORM.  Ignore any jar file given on</span><br><span class="line">      // command line also.</span><br><span class="line">      LOG.info(&quot;The connection manager declares that it self manages mapping&quot;</span><br><span class="line">          + &quot; between records &amp; fields and rows &amp; columns.  The jar file &quot;</span><br><span class="line">          + &quot; provided will have no effect&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    LOG.info(&quot;Using existing jar: &quot; + existingJar);</span><br><span class="line">    return existingJar;</span><br><span class="line">  &#125;</span><br><span class="line">  if (manager.isORMFacilitySelfManaged()) &#123;</span><br><span class="line">    // No need to generated any ORM.  Ignore any jar file given on</span><br><span class="line">    // command line also.</span><br><span class="line">    LOG.info(&quot;The connection manager declares that it self manages mapping&quot;</span><br><span class="line">        + &quot; between records &amp; fields and rows &amp; columns.  No class will&quot;</span><br><span class="line">        + &quot; will be generated.&quot;);</span><br><span class="line">    return null;</span><br><span class="line">  &#125;</span><br><span class="line">  LOG.info(&quot;Beginning code generation&quot;);</span><br><span class="line"></span><br><span class="line">  if (options.getFileLayout() == SqoopOptions.FileLayout.ParquetFile) &#123;</span><br><span class="line">    String className = options.getClassName() != null ?</span><br><span class="line">        options.getClassName() : options.getTableName();</span><br><span class="line">    if (className.equalsIgnoreCase(options.getTableName())) &#123;</span><br><span class="line">      className = &quot;codegen_&quot; + className;</span><br><span class="line">      options.setClassName(className);</span><br><span class="line">      LOG.info(&quot;Will generate java class as &quot; + options.getClassName());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  CompilationManager compileMgr = new CompilationManager(options);</span><br><span class="line">  ClassWriter classWriter = new ClassWriter(options, manager, tableName,</span><br><span class="line">      compileMgr);</span><br><span class="line">  classWriter.generate();</span><br><span class="line">  compileMgr.compile();</span><br><span class="line">  compileMgr.jar();</span><br><span class="line">  String jarFile = compileMgr.getJarFilename();</span><br><span class="line">  this.generatedJarFiles.add(jarFile);</span><br><span class="line">  return jarFile;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 SqoopOptions 类下会保存目标表的所有字段，针对字段会做一个过滤，是否等于 java 保留关键字，如果等于就用在前面加一个 _。<br>通过调用 orm 包下的 ClassWriter 类的 ClassWriter(SqoopOptions opts, ConnManager connMgr, String table, CompilationManager compMgr) 方法，和 generate() 方法来生成一个 .java 文件，路径保存在 orm 包下的 CompilationManager 类的对象中，再经过 compile() 和 jar() 方法来打包生成 表名.jar 文件。这个jar文件和其他选项会构造出一个ImportJobContext对象。</p>
<p>如果是增量模式，initIncrementalConstraints(options, context)会把IncrementalTestColumn的最大值保存在options.incrementalLastValue属性中，作为下一次增量的起点。<br>manager利用ImportJobContext对象中的信息完成表数据的导入。<br>manager完成importTable或importQuery后，程序再根据命令行参数选择将新数据追加到老数据、将新老数据合并或者将新数据导入hive。如果是增量任务，整个ImportTool对象会被保存到metastore。<br>进入importTable方法，该方法有三个实现：</p>
<ol>
<li>DummyManager——主要用于单元测试</li>
<li>MainFrameManager——连接主机，目前只支持通过FTP协议</li>
<li>SqlManager——连接各种支持JDBC连接的数据库</li>
</ol>
<p>SqlManager查询数据库主要有两种方式：本地模式和分布式模式<br>本地模式即直接在当前JVM中查询，比如查询表的结构。<br>分布式模式下进行数据导入导出的查询，如表的导入导出。importTable()方法是一个典型的例子。<br>org.apache.sqoop.manager.SqlManager类</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">public void importTable(com.cloudera.sqoop.manager.ImportJobContext context)</span><br><span class="line">    throws IOException, ImportException &#123;</span><br><span class="line">  String tableName = context.getTableName();</span><br><span class="line">  String jarFile = context.getJarFile();</span><br><span class="line">  SqoopOptions opts = context.getOptions();</span><br><span class="line"></span><br><span class="line">  context.setConnManager(this);</span><br><span class="line"></span><br><span class="line">  ImportJobBase importer;</span><br><span class="line">  if (opts.getHBaseTable() != null) &#123;</span><br><span class="line">    // Import to HBase.</span><br><span class="line">    if (!HBaseUtil.isHBaseJarPresent()) &#123;</span><br><span class="line">      throw new ImportException(&quot;HBase jars are not present in &quot;</span><br><span class="line">          + &quot;classpath, cannot import to HBase!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if (!opts.isBulkLoadEnabled())&#123;</span><br><span class="line">      importer = new HBaseImportJob(opts, context);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      importer = new HBaseBulkImportJob(opts, context);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; else if (opts.getAccumuloTable() != null) &#123;</span><br><span class="line">     // Import to Accumulo.</span><br><span class="line">     if (!AccumuloUtil.isAccumuloJarPresent()) &#123;</span><br><span class="line">       throw new ImportException(&quot;Accumulo jars are not present in &quot;</span><br><span class="line">           + &quot;classpath, cannot import to Accumulo!&quot;);</span><br><span class="line">     &#125;</span><br><span class="line">     importer = new AccumuloImportJob(opts, context);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    // Import to HDFS.</span><br><span class="line">    importer = new DataDrivenImportJob(opts, context.getInputFormat(),</span><br><span class="line">            context);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  checkTableImportOptions(context);</span><br><span class="line"></span><br><span class="line">  String splitCol = getSplitColumn(opts, tableName);</span><br><span class="line">  importer.runImport(tableName, jarFile, splitCol, opts.getConf());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>根据命令行参数的选项，数据将被导入HBase、Accumulo或者HDFS。<br>在DataDrivenImportJob的runImport方法中，可以看到MapReduce Job的构造和提交过程。<br>Job的InputFormat的默认类型是DataDrivenDBInputFormat。OutputFormat默认为null，使用hadoop默认的FileOutputFormat。MapperClass根据输出文件格式的不同而不同。可能的文件格式有纯文本、avro、parquet等。<br>HBaseImportJob、AccumuloImportJob是DataDrivenImportJob的子类。为了将数据导入HBase 和Accumulo，它们实现了不同的MapperClass和OutputFormat。</p>
<p>完成后返回0，程序正常结束。</p>
<h1 id="二、源码修改"><a href="#二、源码修改" class="headerlink" title="二、源码修改"></a>二、源码修改</h1><p>在源码的pom.xml文件中指定了所需的仓库，我们在maven中需要引入该仓库，该仓库中的包可以通过<a target="_blank" rel="noopener" href="https://repository.cloudera.com/ui/">https://repository.cloudera.com/ui/</a> 进行搜索。<br>将maven的settings.xml文件中的仓库设置如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;mirrors&gt;</span><br><span class="line">    &lt;mirror&gt;</span><br><span class="line">        &lt;id&gt;alimaven&lt;/id&gt;</span><br><span class="line">        &lt;name&gt;aliyun maven&lt;/name&gt;</span><br><span class="line">        &lt;url&gt;https://maven.aliyun.com/repository/public&lt;/url&gt;</span><br><span class="line">        &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;</span><br><span class="line">    &lt;/mirror&gt;</span><br><span class="line">    &lt;mirror&gt;</span><br><span class="line">        &lt;id&gt;maven&lt;/id&gt;</span><br><span class="line">        &lt;name&gt;sqoop dependencies maven&lt;/name&gt;</span><br><span class="line">        &lt;url&gt;https://repository.cloudera.com/artifactory/libs-release-local&lt;/url&gt;</span><br><span class="line">        &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;</span><br><span class="line">    &lt;/mirror&gt;</span><br><span class="line">&lt;/mirrors&gt;</span><br></pre></td></tr></table></figure>



<br>
<br>
Sqlmanager 类下在获取到参数后，会先尝试连接一下数据库，执行一个 select t.* from XX as t limit 1 的语句。
mysql 和 hadoop 连接的时候使用的是 SqlManager 类，如果是 import 调用的是 importTable 方法，如果是 export 调用的是 exportTable 方法。根据生成的 ExportJobContext 上下文实例，执行 runExport() 方法，调用的是 mapreduce 包下的 ExportJobBase 类的方法。

<p>配置好 job 相关信息，执行 runJob(job) 方法。<br>在 hive export to mysql 时，如果字段还有特殊字符，可能会出现因为切分数据而导致数据错位导致推数失败的情况。如果要对 hive 表中的数据进行处理的话，需要在 mapreduce 包下找到对应的 mapper 类（根据 hive 表类型划分为 TextExportMapper、ParquetMapper、SequenceFileMapper 等）<br>具体解析参数是在 SqoopParser 类下的 processArgs(Option opt, ListIterator iter) 方法<br>sqoopTool：sqoop具体的工具类</p>
<p>Hive 用增量<br>采集、建模需要固定的时间段，昨天9点到今天9点，限制住时间，或者要先获取到上次执行时间，再算上这次的执行时间。建模无法获取上次的执行时间，如果固定时间间隔，如果报错后续处理，比如垮天了，或者白天执行作业的时候就会很麻烦。<br>Hive不支持删除数据，对于不要的数据只能全量执行，不管是采集还是建模。<br>如果业务那边有一个base_table，每天的一个增量表，可以做成拉链表。燃气设备是做成了拉链表，是在源头做的，不是在hive</p>
<p>kpi 是增量插入一天一条，但是如果存在回补历史数据或者修正历史数据，比如某一天的数据就很麻烦。</p>
<br>
<br>
<br>
<br>
<br>
<br>
sqoop
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">#</span><br><span class="line"># Copyright 2011 The Apache Software Foundation</span><br><span class="line">#</span><br><span class="line"># Licensed to the Apache Software Foundation (ASF) under one</span><br><span class="line"># or more contributor license agreements.  See the NOTICE file</span><br><span class="line"># distributed with this work for additional information</span><br><span class="line"># regarding copyright ownership.  The ASF licenses this file</span><br><span class="line"># to you under the Apache License, Version 2.0 (the</span><br><span class="line"># &quot;License&quot;); you may not use this file except in compliance</span><br><span class="line"># with the License.  You may obtain a copy of the License at</span><br><span class="line">#</span><br><span class="line">#     http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="line">#</span><br><span class="line"># Unless required by applicable law or agreed to in writing, software</span><br><span class="line"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="line"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line"># See the License for the specific language governing permissions and</span><br><span class="line"># limitations under the License.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">follow_one() &#123;</span><br><span class="line">  # Resolve symlinks and relative path components along a path.  This requires</span><br><span class="line">  # its argument to be an absolute path.  This does not recursively re-resolve</span><br><span class="line">  # symlinks; if that is required, use the &#x27;follow&#x27; method.</span><br><span class="line"></span><br><span class="line">  target=$1</span><br><span class="line">  OIFS=$IFS</span><br><span class="line">  IFS=&#x27;/&#x27;</span><br><span class="line"></span><br><span class="line">  # Taking each dir component along the way, build up a new target directory,</span><br><span class="line">  # resolving &#x27;.&#x27;, &#x27;..&#x27;, and symlinks.</span><br><span class="line">  newtarget=&#x27;&#x27;</span><br><span class="line">  for part in $&#123;target&#125;; do</span><br><span class="line">    if [ -z &quot;$&#123;part&#125;&quot; ]; then</span><br><span class="line">      continue # Empty dir part. &#x27;foo//bar&#x27;</span><br><span class="line">    elif [ &quot;.&quot; == &quot;$&#123;part&#125;&quot; ]; then</span><br><span class="line">      continue # Nothing special to do for &#x27;.&#x27;</span><br><span class="line">    elif  [ &quot;..&quot; == &quot;$&#123;part&#125;&quot; ]; then</span><br><span class="line">      IFS=$OIFS</span><br><span class="line">      newtarget=`dirname $&#123;newtarget&#125;` # pop a component.</span><br><span class="line">    elif [ -h &quot;$&#123;newtarget&#125;/$&#123;part&#125;&quot; ]; then</span><br><span class="line">      IFS=$OIFS</span><br><span class="line">      link=`readlink $&#123;newtarget&#125;/$&#123;part&#125;`</span><br><span class="line">      # links can be relative or absolute. Relative ones get appended to</span><br><span class="line">      # newtarget; absolute ones replace it.</span><br><span class="line">      if [ &quot;$&#123;link:0:1&#125;&quot; != &quot;/&quot;  ]; then</span><br><span class="line">        newtarget=&quot;$&#123;newtarget&#125;/$&#123;link&#125;&quot; # relative</span><br><span class="line">      else</span><br><span class="line">        newtarget=&quot;$&#123;link&#125;&quot; # absolute</span><br><span class="line">      fi</span><br><span class="line">    else # Regular file component.</span><br><span class="line">      newtarget=&quot;$&#123;newtarget&#125;/$&#123;part&#125;&quot;</span><br><span class="line">    fi</span><br><span class="line">    IFS=&#x27;/&#x27;</span><br><span class="line">  done</span><br><span class="line"></span><br><span class="line">  IFS=$OIFS</span><br><span class="line">  echo $newtarget</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">follow() &#123;</span><br><span class="line">  # Portable &#x27;readlink -f&#x27; function to follow a file&#x27;s links to the final</span><br><span class="line">  # target.  Calls follow_one recursively til we&#x27;re finished tracing symlinks.</span><br><span class="line"></span><br><span class="line">  target=$1</span><br><span class="line">  depth=$2</span><br><span class="line"></span><br><span class="line">  if [ -z &quot;$depth&quot; ]; then</span><br><span class="line">    depth=0</span><br><span class="line">  elif [ &quot;$depth&quot; == &quot;1000&quot; ]; then</span><br><span class="line">    # Don&#x27;t recurse indefinitely; we&#x27;ve probably hit a symlink cycle.</span><br><span class="line">    # Just bail out here.</span><br><span class="line">    echo $target</span><br><span class="line">    return 1</span><br><span class="line">  fi</span><br><span class="line"></span><br><span class="line">  # Canonicalize the target to be an absolute path.</span><br><span class="line">  targetdir=`dirname $&#123;target&#125;`</span><br><span class="line">  targetdir=`cd $&#123;targetdir&#125; &amp;&amp; pwd`</span><br><span class="line">  target=$&#123;targetdir&#125;/`basename $&#123;target&#125;`</span><br><span class="line"></span><br><span class="line">  # Use follow_one to resolve links. Test that we get the same result twice,</span><br><span class="line">  # to terminate iteration.</span><br><span class="line">  first=`follow_one $&#123;target&#125;`</span><br><span class="line">  second=`follow_one $&#123;first&#125;`</span><br><span class="line">  if [ &quot;$&#123;first&#125;&quot; == &quot;$&#123;second&#125;&quot; ]; then</span><br><span class="line">    # We&#x27;re done.</span><br><span class="line">    echo &quot;$&#123;second&#125;&quot;</span><br><span class="line">  else</span><br><span class="line">    # Need to continue resolving links.</span><br><span class="line">    echo `follow $&#123;second&#125; $(( $depth + 1 ))`</span><br><span class="line">  fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">prgm=`follow $0`</span><br><span class="line">bin=`dirname $&#123;prgm&#125;`</span><br><span class="line">bin=`cd $&#123;bin&#125; &amp;&amp; pwd`</span><br><span class="line"></span><br><span class="line">source $&#123;bin&#125;/configure-sqoop &quot;$&#123;bin&#125;&quot;</span><br><span class="line">exec $&#123;HADOOP_COMMON_HOME&#125;/bin/hadoop org.apache.sqoop.Sqoop &quot;$@&quot;</span><br></pre></td></tr></table></figure>

<p>java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br></pre></td><td class="code"><pre><span class="line">// ORM class for table &#x27;ca_sales&#x27;</span><br><span class="line">// WARNING: This class is AUTO-GENERATED. Modify at your own risk.</span><br><span class="line">//</span><br><span class="line">// Debug information:</span><br><span class="line">// Generated date: Wed Sep 01 15:47:37 CST 2021</span><br><span class="line">// For connector: org.apache.sqoop.manager.MySQLManager</span><br><span class="line">import org.apache.hadoop.io.BytesWritable;</span><br><span class="line">import org.apache.hadoop.io.Text;</span><br><span class="line">import org.apache.hadoop.io.Writable;</span><br><span class="line">import org.apache.hadoop.mapred.lib.db.DBWritable;</span><br><span class="line">import com.cloudera.sqoop.lib.JdbcWritableBridge;</span><br><span class="line">import com.cloudera.sqoop.lib.DelimiterSet;</span><br><span class="line">import com.cloudera.sqoop.lib.FieldFormatter;</span><br><span class="line">import com.cloudera.sqoop.lib.RecordParser;</span><br><span class="line">import com.cloudera.sqoop.lib.BooleanParser;</span><br><span class="line">import com.cloudera.sqoop.lib.BlobRef;</span><br><span class="line">import com.cloudera.sqoop.lib.ClobRef;</span><br><span class="line">import com.cloudera.sqoop.lib.LargeObjectLoader;</span><br><span class="line">import com.cloudera.sqoop.lib.SqoopRecord;</span><br><span class="line">import java.sql.PreparedStatement;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.io.DataInput;</span><br><span class="line">import java.io.DataOutput;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.nio.ByteBuffer;</span><br><span class="line">import java.nio.CharBuffer;</span><br><span class="line">import java.sql.Date;</span><br><span class="line">import java.sql.Time;</span><br><span class="line">import java.sql.Timestamp;</span><br><span class="line">import java.util.Arrays;</span><br><span class="line">import java.util.Iterator;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.TreeMap;</span><br><span class="line"></span><br><span class="line">public class ca_sales extends SqoopRecord  implements DBWritable, Writable &#123;</span><br><span class="line">  private final int PROTOCOL_VERSION = 3;</span><br><span class="line">  public int getClassFormatVersion() &#123; return PROTOCOL_VERSION; &#125;</span><br><span class="line">  protected ResultSet __cur_result_set;</span><br><span class="line">  private Integer type;</span><br><span class="line">  public Integer get_type() &#123;</span><br><span class="line">    return type;</span><br><span class="line">  &#125;</span><br><span class="line">  public void set_type(Integer type) &#123;</span><br><span class="line">    this.type = type;</span><br><span class="line">  &#125;</span><br><span class="line">  public ca_sales with_type(Integer type) &#123;</span><br><span class="line">    this.type = type;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;</span><br><span class="line">  private String device_code;</span><br><span class="line">  public String get_device_code() &#123;</span><br><span class="line">    return device_code;</span><br><span class="line">  &#125;</span><br><span class="line">  public void set_device_code(String device_code) &#123;</span><br><span class="line">    this.device_code = device_code;</span><br><span class="line">  &#125;</span><br><span class="line">  public ca_sales with_device_code(String device_code) &#123;</span><br><span class="line">    this.device_code = device_code;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;</span><br><span class="line">  private java.sql.Date sales_date;</span><br><span class="line">  public java.sql.Date get_sales_date() &#123;</span><br><span class="line">    return sales_date;</span><br><span class="line">  &#125;</span><br><span class="line">  public void set_sales_date(java.sql.Date sales_date) &#123;</span><br><span class="line">    this.sales_date = sales_date;</span><br><span class="line">  &#125;</span><br><span class="line">  public ca_sales with_sales_date(java.sql.Date sales_date) &#123;</span><br><span class="line">    this.sales_date = sales_date;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;</span><br><span class="line">  private Integer sales_num;</span><br><span class="line">  public Integer get_sales_num() &#123;</span><br><span class="line">    return sales_num;</span><br><span class="line">  &#125;</span><br><span class="line">  public void set_sales_num(Integer sales_num) &#123;</span><br><span class="line">    this.sales_num = sales_num;</span><br><span class="line">  &#125;</span><br><span class="line">  public ca_sales with_sales_num(Integer sales_num) &#123;</span><br><span class="line">    this.sales_num = sales_num;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;</span><br><span class="line">  private Float sales_money;</span><br><span class="line">  public Float get_sales_money() &#123;</span><br><span class="line">    return sales_money;</span><br><span class="line">  &#125;</span><br><span class="line">  public void set_sales_money(Float sales_money) &#123;</span><br><span class="line">    this.sales_money = sales_money;</span><br><span class="line">  &#125;</span><br><span class="line">  public ca_sales with_sales_money(Float sales_money) &#123;</span><br><span class="line">    this.sales_money = sales_money;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;</span><br><span class="line">  private Integer send_num;</span><br><span class="line">  public Integer get_send_num() &#123;</span><br><span class="line">    return send_num;</span><br><span class="line">  &#125;</span><br><span class="line">  public void set_send_num(Integer send_num) &#123;</span><br><span class="line">    this.send_num = send_num;</span><br><span class="line">  &#125;</span><br><span class="line">  public ca_sales with_send_num(Integer send_num) &#123;</span><br><span class="line">    this.send_num = send_num;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;</span><br><span class="line">  private java.sql.Timestamp create_time;</span><br><span class="line">  public java.sql.Timestamp get_create_time() &#123;</span><br><span class="line">    return create_time;</span><br><span class="line">  &#125;</span><br><span class="line">  public void set_create_time(java.sql.Timestamp create_time) &#123;</span><br><span class="line">    this.create_time = create_time;</span><br><span class="line">  &#125;</span><br><span class="line">  public ca_sales with_create_time(java.sql.Timestamp create_time) &#123;</span><br><span class="line">    this.create_time = create_time;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;</span><br><span class="line">  private java.sql.Timestamp update_time;</span><br><span class="line">  public java.sql.Timestamp get_update_time() &#123;</span><br><span class="line">    return update_time;</span><br><span class="line">  &#125;</span><br><span class="line">  public void set_update_time(java.sql.Timestamp update_time) &#123;</span><br><span class="line">    this.update_time = update_time;</span><br><span class="line">  &#125;</span><br><span class="line">  public ca_sales with_update_time(java.sql.Timestamp update_time) &#123;</span><br><span class="line">    this.update_time = update_time;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;</span><br><span class="line">  public boolean equals(Object o) &#123;</span><br><span class="line">    if (this == o) &#123;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    if (!(o instanceof ca_sales)) &#123;</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line">    ca_sales that = (ca_sales) o;</span><br><span class="line">    boolean equal = true;</span><br><span class="line">    equal = equal &amp;&amp; (this.type == null ? that.type == null : this.type.equals(that.type));</span><br><span class="line">    equal = equal &amp;&amp; (this.device_code == null ? that.device_code == null : this.device_code.equals(that.device_code));</span><br><span class="line">    equal = equal &amp;&amp; (this.sales_date == null ? that.sales_date == null : this.sales_date.equals(that.sales_date));</span><br><span class="line">    equal = equal &amp;&amp; (this.sales_num == null ? that.sales_num == null : this.sales_num.equals(that.sales_num));</span><br><span class="line">    equal = equal &amp;&amp; (this.sales_money == null ? that.sales_money == null : this.sales_money.equals(that.sales_money));</span><br><span class="line">    equal = equal &amp;&amp; (this.send_num == null ? that.send_num == null : this.send_num.equals(that.send_num));</span><br><span class="line">    equal = equal &amp;&amp; (this.create_time == null ? that.create_time == null : this.create_time.equals(that.create_time));</span><br><span class="line">    equal = equal &amp;&amp; (this.update_time == null ? that.update_time == null : this.update_time.equals(that.update_time));</span><br><span class="line">    return equal;</span><br><span class="line">  &#125;</span><br><span class="line">  public boolean equals0(Object o) &#123;</span><br><span class="line">    if (this == o) &#123;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    if (!(o instanceof ca_sales)) &#123;</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line">    ca_sales that = (ca_sales) o;</span><br><span class="line">    boolean equal = true;</span><br><span class="line">    equal = equal &amp;&amp; (this.type == null ? that.type == null : this.type.equals(that.type));</span><br><span class="line">    equal = equal &amp;&amp; (this.device_code == null ? that.device_code == null : this.device_code.equals(that.device_code));</span><br><span class="line">    equal = equal &amp;&amp; (this.sales_date == null ? that.sales_date == null : this.sales_date.equals(that.sales_date));</span><br><span class="line">    equal = equal &amp;&amp; (this.sales_num == null ? that.sales_num == null : this.sales_num.equals(that.sales_num));</span><br><span class="line">    equal = equal &amp;&amp; (this.sales_money == null ? that.sales_money == null : this.sales_money.equals(that.sales_money));</span><br><span class="line">    equal = equal &amp;&amp; (this.send_num == null ? that.send_num == null : this.send_num.equals(that.send_num));</span><br><span class="line">    equal = equal &amp;&amp; (this.create_time == null ? that.create_time == null : this.create_time.equals(that.create_time));</span><br><span class="line">    equal = equal &amp;&amp; (this.update_time == null ? that.update_time == null : this.update_time.equals(that.update_time));</span><br><span class="line">    return equal;</span><br><span class="line">  &#125;</span><br><span class="line">  public void readFields(ResultSet __dbResults) throws SQLException &#123;</span><br><span class="line">    this.__cur_result_set = __dbResults;</span><br><span class="line">    this.type = JdbcWritableBridge.readInteger(1, __dbResults);</span><br><span class="line">    this.device_code = JdbcWritableBridge.readString(2, __dbResults);</span><br><span class="line">    this.sales_date = JdbcWritableBridge.readDate(3, __dbResults);</span><br><span class="line">    this.sales_num = JdbcWritableBridge.readInteger(4, __dbResults);</span><br><span class="line">    this.sales_money = JdbcWritableBridge.readFloat(5, __dbResults);</span><br><span class="line">    this.send_num = JdbcWritableBridge.readInteger(6, __dbResults);</span><br><span class="line">    this.create_time = JdbcWritableBridge.readTimestamp(7, __dbResults);</span><br><span class="line">    this.update_time = JdbcWritableBridge.readTimestamp(8, __dbResults);</span><br><span class="line">  &#125;</span><br><span class="line">  public void readFields0(ResultSet __dbResults) throws SQLException &#123;</span><br><span class="line">    this.type = JdbcWritableBridge.readInteger(1, __dbResults);</span><br><span class="line">    this.device_code = JdbcWritableBridge.readString(2, __dbResults);</span><br><span class="line">    this.sales_date = JdbcWritableBridge.readDate(3, __dbResults);</span><br><span class="line">    this.sales_num = JdbcWritableBridge.readInteger(4, __dbResults);</span><br><span class="line">    this.sales_money = JdbcWritableBridge.readFloat(5, __dbResults);</span><br><span class="line">    this.send_num = JdbcWritableBridge.readInteger(6, __dbResults);</span><br><span class="line">    this.create_time = JdbcWritableBridge.readTimestamp(7, __dbResults);</span><br><span class="line">    this.update_time = JdbcWritableBridge.readTimestamp(8, __dbResults);</span><br><span class="line">  &#125;</span><br><span class="line">  public void loadLargeObjects(LargeObjectLoader __loader)</span><br><span class="line">      throws SQLException, IOException, InterruptedException &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  public void loadLargeObjects0(LargeObjectLoader __loader)</span><br><span class="line">      throws SQLException, IOException, InterruptedException &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  public void write(PreparedStatement __dbStmt) throws SQLException &#123;</span><br><span class="line">    write(__dbStmt, 0);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public int write(PreparedStatement __dbStmt, int __off) throws SQLException &#123;</span><br><span class="line">    JdbcWritableBridge.writeInteger(type, 1 + __off, 4, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeString(device_code, 2 + __off, 12, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeDate(sales_date, 3 + __off, 91, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeInteger(sales_num, 4 + __off, 4, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeFloat(sales_money, 5 + __off, 7, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeInteger(send_num, 6 + __off, 4, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeTimestamp(create_time, 7 + __off, 93, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeTimestamp(update_time, 8 + __off, 93, __dbStmt);</span><br><span class="line">    return 8;</span><br><span class="line">  &#125;</span><br><span class="line">  public void write0(PreparedStatement __dbStmt, int __off) throws SQLException &#123;</span><br><span class="line">    JdbcWritableBridge.writeInteger(type, 1 + __off, 4, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeString(device_code, 2 + __off, 12, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeDate(sales_date, 3 + __off, 91, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeInteger(sales_num, 4 + __off, 4, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeFloat(sales_money, 5 + __off, 7, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeInteger(send_num, 6 + __off, 4, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeTimestamp(create_time, 7 + __off, 93, __dbStmt);</span><br><span class="line">    JdbcWritableBridge.writeTimestamp(update_time, 8 + __off, 93, __dbStmt);</span><br><span class="line">  &#125;</span><br><span class="line">  public void readFields(DataInput __dataIn) throws IOException &#123;</span><br><span class="line">this.readFields0(__dataIn);  &#125;</span><br><span class="line">  public void readFields0(DataInput __dataIn) throws IOException &#123;</span><br><span class="line">    if (__dataIn.readBoolean()) &#123; </span><br><span class="line">        this.type = null;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    this.type = Integer.valueOf(__dataIn.readInt());</span><br><span class="line">    &#125;</span><br><span class="line">    if (__dataIn.readBoolean()) &#123; </span><br><span class="line">        this.device_code = null;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    this.device_code = Text.readString(__dataIn);</span><br><span class="line">    &#125;</span><br><span class="line">    if (__dataIn.readBoolean()) &#123; </span><br><span class="line">        this.sales_date = null;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    this.sales_date = new Date(__dataIn.readLong());</span><br><span class="line">    &#125;</span><br><span class="line">    if (__dataIn.readBoolean()) &#123; </span><br><span class="line">        this.sales_num = null;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    this.sales_num = Integer.valueOf(__dataIn.readInt());</span><br><span class="line">    &#125;</span><br><span class="line">    if (__dataIn.readBoolean()) &#123; </span><br><span class="line">        this.sales_money = null;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    this.sales_money = Float.valueOf(__dataIn.readFloat());</span><br><span class="line">    &#125;</span><br><span class="line">    if (__dataIn.readBoolean()) &#123; </span><br><span class="line">        this.send_num = null;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    this.send_num = Integer.valueOf(__dataIn.readInt());</span><br><span class="line">    &#125;</span><br><span class="line">    if (__dataIn.readBoolean()) &#123; </span><br><span class="line">        this.create_time = null;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    this.create_time = new Timestamp(__dataIn.readLong());</span><br><span class="line">    this.create_time.setNanos(__dataIn.readInt());</span><br><span class="line">    &#125;</span><br><span class="line">    if (__dataIn.readBoolean()) &#123; </span><br><span class="line">        this.update_time = null;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    this.update_time = new Timestamp(__dataIn.readLong());</span><br><span class="line">    this.update_time.setNanos(__dataIn.readInt());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  public void write(DataOutput __dataOut) throws IOException &#123;</span><br><span class="line">    if (null == this.type) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeInt(this.type);</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.device_code) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    Text.writeString(__dataOut, device_code);</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.sales_date) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeLong(this.sales_date.getTime());</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.sales_num) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeInt(this.sales_num);</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.sales_money) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeFloat(this.sales_money);</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.send_num) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeInt(this.send_num);</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.create_time) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeLong(this.create_time.getTime());</span><br><span class="line">    __dataOut.writeInt(this.create_time.getNanos());</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.update_time) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeLong(this.update_time.getTime());</span><br><span class="line">    __dataOut.writeInt(this.update_time.getNanos());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  public void write0(DataOutput __dataOut) throws IOException &#123;</span><br><span class="line">    if (null == this.type) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeInt(this.type);</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.device_code) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    Text.writeString(__dataOut, device_code);</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.sales_date) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeLong(this.sales_date.getTime());</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.sales_num) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeInt(this.sales_num);</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.sales_money) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeFloat(this.sales_money);</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.send_num) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeInt(this.send_num);</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.create_time) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeLong(this.create_time.getTime());</span><br><span class="line">    __dataOut.writeInt(this.create_time.getNanos());</span><br><span class="line">    &#125;</span><br><span class="line">    if (null == this.update_time) &#123; </span><br><span class="line">        __dataOut.writeBoolean(true);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        __dataOut.writeBoolean(false);</span><br><span class="line">    __dataOut.writeLong(this.update_time.getTime());</span><br><span class="line">    __dataOut.writeInt(this.update_time.getNanos());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  private static final DelimiterSet __outputDelimiters = new DelimiterSet((char) 44, (char) 10, (char) 0, (char) 0, false);</span><br><span class="line">  public String toString() &#123;</span><br><span class="line">    return toString(__outputDelimiters, true);</span><br><span class="line">  &#125;</span><br><span class="line">  public String toString(DelimiterSet delimiters) &#123;</span><br><span class="line">    return toString(delimiters, true);</span><br><span class="line">  &#125;</span><br><span class="line">  public String toString(boolean useRecordDelim) &#123;</span><br><span class="line">    return toString(__outputDelimiters, useRecordDelim);</span><br><span class="line">  &#125;</span><br><span class="line">  public String toString(DelimiterSet delimiters, boolean useRecordDelim) &#123;</span><br><span class="line">    StringBuilder __sb = new StringBuilder();</span><br><span class="line">    char fieldDelim = delimiters.getFieldsTerminatedBy();</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(type==null?&quot;null&quot;:&quot;&quot; + type, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(device_code==null?&quot;null&quot;:device_code, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(sales_date==null?&quot;null&quot;:&quot;&quot; + sales_date, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(sales_num==null?&quot;null&quot;:&quot;&quot; + sales_num, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(sales_money==null?&quot;null&quot;:&quot;&quot; + sales_money, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(send_num==null?&quot;null&quot;:&quot;&quot; + send_num, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(create_time==null?&quot;null&quot;:&quot;&quot; + create_time, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(update_time==null?&quot;null&quot;:&quot;&quot; + update_time, delimiters));</span><br><span class="line">    if (useRecordDelim) &#123;</span><br><span class="line">      __sb.append(delimiters.getLinesTerminatedBy());</span><br><span class="line">    &#125;</span><br><span class="line">    return __sb.toString();</span><br><span class="line">  &#125;</span><br><span class="line">  public void toString0(DelimiterSet delimiters, StringBuilder __sb, char fieldDelim) &#123;</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(type==null?&quot;null&quot;:&quot;&quot; + type, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(device_code==null?&quot;null&quot;:device_code, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(sales_date==null?&quot;null&quot;:&quot;&quot; + sales_date, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(sales_num==null?&quot;null&quot;:&quot;&quot; + sales_num, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(sales_money==null?&quot;null&quot;:&quot;&quot; + sales_money, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(send_num==null?&quot;null&quot;:&quot;&quot; + send_num, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(create_time==null?&quot;null&quot;:&quot;&quot; + create_time, delimiters));</span><br><span class="line">    __sb.append(fieldDelim);</span><br><span class="line">    __sb.append(FieldFormatter.escapeAndEnclose(update_time==null?&quot;null&quot;:&quot;&quot; + update_time, delimiters));</span><br><span class="line">  &#125;</span><br><span class="line">  private static final DelimiterSet __inputDelimiters = new DelimiterSet((char) 9, (char) 10, (char) 0, (char) 0, false);</span><br><span class="line">  private RecordParser __parser;</span><br><span class="line">  public void parse(Text __record) throws RecordParser.ParseError &#123;</span><br><span class="line">    if (null == this.__parser) &#123;</span><br><span class="line">      this.__parser = new RecordParser(__inputDelimiters);</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;String&gt; __fields = this.__parser.parseRecord(__record);</span><br><span class="line">    __loadFromFields(__fields);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void parse(CharSequence __record) throws RecordParser.ParseError &#123;</span><br><span class="line">    if (null == this.__parser) &#123;</span><br><span class="line">      this.__parser = new RecordParser(__inputDelimiters);</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;String&gt; __fields = this.__parser.parseRecord(__record);</span><br><span class="line">    __loadFromFields(__fields);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void parse(byte [] __record) throws RecordParser.ParseError &#123;</span><br><span class="line">    if (null == this.__parser) &#123;</span><br><span class="line">      this.__parser = new RecordParser(__inputDelimiters);</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;String&gt; __fields = this.__parser.parseRecord(__record);</span><br><span class="line">    __loadFromFields(__fields);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void parse(char [] __record) throws RecordParser.ParseError &#123;</span><br><span class="line">    if (null == this.__parser) &#123;</span><br><span class="line">      this.__parser = new RecordParser(__inputDelimiters);</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;String&gt; __fields = this.__parser.parseRecord(__record);</span><br><span class="line">    __loadFromFields(__fields);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void parse(ByteBuffer __record) throws RecordParser.ParseError &#123;</span><br><span class="line">    if (null == this.__parser) &#123;</span><br><span class="line">      this.__parser = new RecordParser(__inputDelimiters);</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;String&gt; __fields = this.__parser.parseRecord(__record);</span><br><span class="line">    __loadFromFields(__fields);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void parse(CharBuffer __record) throws RecordParser.ParseError &#123;</span><br><span class="line">    if (null == this.__parser) &#123;</span><br><span class="line">      this.__parser = new RecordParser(__inputDelimiters);</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;String&gt; __fields = this.__parser.parseRecord(__record);</span><br><span class="line">    __loadFromFields(__fields);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void __loadFromFields(List&lt;String&gt; fields) &#123;</span><br><span class="line">    Iterator&lt;String&gt; __it = fields.listIterator();</span><br><span class="line">    String __cur_str = null;</span><br><span class="line">    try &#123;</span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.type = null; &#125; else &#123;</span><br><span class="line">      this.type = Integer.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;)) &#123; this.device_code = null; &#125; else &#123;</span><br><span class="line">      this.device_code = __cur_str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.sales_date = null; &#125; else &#123;</span><br><span class="line">      this.sales_date = java.sql.Date.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.sales_num = null; &#125; else &#123;</span><br><span class="line">      this.sales_num = Integer.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.sales_money = null; &#125; else &#123;</span><br><span class="line">      this.sales_money = Float.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.send_num = null; &#125; else &#123;</span><br><span class="line">      this.send_num = Integer.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.create_time = null; &#125; else &#123;</span><br><span class="line">      this.create_time = java.sql.Timestamp.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.update_time = null; &#125; else &#123;</span><br><span class="line">      this.update_time = java.sql.Timestamp.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#125; catch (RuntimeException e) &#123;    throw new RuntimeException(&quot;Can&#x27;t parse input data: &#x27;&quot; + __cur_str + &quot;&#x27;&quot;, e);    &#125;  &#125;</span><br><span class="line"></span><br><span class="line">  private void __loadFromFields0(Iterator&lt;String&gt; __it) &#123;</span><br><span class="line">    String __cur_str = null;</span><br><span class="line">    try &#123;</span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.type = null; &#125; else &#123;</span><br><span class="line">      this.type = Integer.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;)) &#123; this.device_code = null; &#125; else &#123;</span><br><span class="line">      this.device_code = __cur_str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.sales_date = null; &#125; else &#123;</span><br><span class="line">      this.sales_date = java.sql.Date.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.sales_num = null; &#125; else &#123;</span><br><span class="line">      this.sales_num = Integer.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.sales_money = null; &#125; else &#123;</span><br><span class="line">      this.sales_money = Float.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.send_num = null; &#125; else &#123;</span><br><span class="line">      this.send_num = Integer.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.create_time = null; &#125; else &#123;</span><br><span class="line">      this.create_time = java.sql.Timestamp.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __cur_str = __it.next();</span><br><span class="line">    if (__cur_str.equals(&quot;\N&quot;) || __cur_str.length() == 0) &#123; this.update_time = null; &#125; else &#123;</span><br><span class="line">      this.update_time = java.sql.Timestamp.valueOf(__cur_str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#125; catch (RuntimeException e) &#123;    throw new RuntimeException(&quot;Can&#x27;t parse input data: &#x27;&quot; + __cur_str + &quot;&#x27;&quot;, e);    &#125;  &#125;</span><br><span class="line"></span><br><span class="line">  public Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line">    ca_sales o = (ca_sales) super.clone();</span><br><span class="line">    o.sales_date = (o.sales_date != null) ? (java.sql.Date) o.sales_date.clone() : null;</span><br><span class="line">    o.create_time = (o.create_time != null) ? (java.sql.Timestamp) o.create_time.clone() : null;</span><br><span class="line">    o.update_time = (o.update_time != null) ? (java.sql.Timestamp) o.update_time.clone() : null;</span><br><span class="line">    return o;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void clone0(ca_sales o) throws CloneNotSupportedException &#123;</span><br><span class="line">    o.sales_date = (o.sales_date != null) ? (java.sql.Date) o.sales_date.clone() : null;</span><br><span class="line">    o.create_time = (o.create_time != null) ? (java.sql.Timestamp) o.create_time.clone() : null;</span><br><span class="line">    o.update_time = (o.update_time != null) ? (java.sql.Timestamp) o.update_time.clone() : null;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public Map&lt;String, Object&gt; getFieldMap() &#123;</span><br><span class="line">    Map&lt;String, Object&gt; __sqoop$field_map = new TreeMap&lt;String, Object&gt;();</span><br><span class="line">    __sqoop$field_map.put(&quot;type&quot;, this.type);</span><br><span class="line">    __sqoop$field_map.put(&quot;device_code&quot;, this.device_code);</span><br><span class="line">    __sqoop$field_map.put(&quot;sales_date&quot;, this.sales_date);</span><br><span class="line">    __sqoop$field_map.put(&quot;sales_num&quot;, this.sales_num);</span><br><span class="line">    __sqoop$field_map.put(&quot;sales_money&quot;, this.sales_money);</span><br><span class="line">    __sqoop$field_map.put(&quot;send_num&quot;, this.send_num);</span><br><span class="line">    __sqoop$field_map.put(&quot;create_time&quot;, this.create_time);</span><br><span class="line">    __sqoop$field_map.put(&quot;update_time&quot;, this.update_time);</span><br><span class="line">    return __sqoop$field_map;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void getFieldMap0(Map&lt;String, Object&gt; __sqoop$field_map) &#123;</span><br><span class="line">    __sqoop$field_map.put(&quot;type&quot;, this.type);</span><br><span class="line">    __sqoop$field_map.put(&quot;device_code&quot;, this.device_code);</span><br><span class="line">    __sqoop$field_map.put(&quot;sales_date&quot;, this.sales_date);</span><br><span class="line">    __sqoop$field_map.put(&quot;sales_num&quot;, this.sales_num);</span><br><span class="line">    __sqoop$field_map.put(&quot;sales_money&quot;, this.sales_money);</span><br><span class="line">    __sqoop$field_map.put(&quot;send_num&quot;, this.send_num);</span><br><span class="line">    __sqoop$field_map.put(&quot;create_time&quot;, this.create_time);</span><br><span class="line">    __sqoop$field_map.put(&quot;update_time&quot;, this.update_time);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void setField(String __fieldName, Object __fieldVal) &#123;</span><br><span class="line">    if (&quot;type&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.type = (Integer) __fieldVal;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;device_code&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.device_code = (String) __fieldVal;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;sales_date&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.sales_date = (java.sql.Date) __fieldVal;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;sales_num&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.sales_num = (Integer) __fieldVal;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;sales_money&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.sales_money = (Float) __fieldVal;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;send_num&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.send_num = (Integer) __fieldVal;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;create_time&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.create_time = (java.sql.Timestamp) __fieldVal;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;update_time&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.update_time = (java.sql.Timestamp) __fieldVal;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">      throw new RuntimeException(&quot;No such field: &quot; + __fieldName);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  public boolean setField0(String __fieldName, Object __fieldVal) &#123;</span><br><span class="line">    if (&quot;type&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.type = (Integer) __fieldVal;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;device_code&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.device_code = (String) __fieldVal;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;sales_date&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.sales_date = (java.sql.Date) __fieldVal;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;sales_num&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.sales_num = (Integer) __fieldVal;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;sales_money&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.sales_money = (Float) __fieldVal;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;send_num&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.send_num = (Integer) __fieldVal;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;create_time&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.create_time = (java.sql.Timestamp) __fieldVal;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    else    if (&quot;update_time&quot;.equals(__fieldName)) &#123;</span><br><span class="line">      this.update_time = (java.sql.Timestamp) __fieldVal;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">      return false;    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>hadoop</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env bash</span><br><span class="line"></span><br><span class="line"># Licensed to the Apache Software Foundation (ASF) under one or more</span><br><span class="line"># contributor license agreements.  See the NOTICE file distributed with</span><br><span class="line"># this work for additional information regarding copyright ownership.</span><br><span class="line"># The ASF licenses this file to You under the Apache License, Version 2.0</span><br><span class="line"># (the &quot;License&quot;); you may not use this file except in compliance with</span><br><span class="line"># the License.  You may obtain a copy of the License at</span><br><span class="line">#</span><br><span class="line">#     http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="line">#</span><br><span class="line"># Unless required by applicable law or agreed to in writing, software</span><br><span class="line"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="line"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line"># See the License for the specific language governing permissions and</span><br><span class="line"># limitations under the License.</span><br><span class="line"></span><br><span class="line"># The name of the script being executed.</span><br><span class="line">HADOOP_SHELL_EXECNAME=&quot;hadoop&quot;</span><br><span class="line">MYNAME=&quot;$&#123;BASH_SOURCE-$0&#125;&quot;</span><br><span class="line"></span><br><span class="line">## @description  build up the hadoop command&#x27;s usage text.</span><br><span class="line">## @audience     public</span><br><span class="line">## @stability    stable</span><br><span class="line">## @replaceable  no</span><br><span class="line">function hadoop_usage</span><br><span class="line">&#123;</span><br><span class="line">  hadoop_add_option &quot;buildpaths&quot; &quot;attempt to add class files from build tree&quot;</span><br><span class="line">  hadoop_add_option &quot;hostnames list[,of,host,names]&quot; &quot;hosts to use in slave mode&quot;</span><br><span class="line">  hadoop_add_option &quot;loglevel level&quot; &quot;set the log4j level for this command&quot;</span><br><span class="line">  hadoop_add_option &quot;hosts filename&quot; &quot;list of hosts to use in slave mode&quot;</span><br><span class="line">  hadoop_add_option &quot;workers&quot; &quot;turn on worker mode&quot;</span><br><span class="line"></span><br><span class="line">  hadoop_add_subcommand &quot;checknative&quot; client &quot;check native Hadoop and compression libraries availability&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;classpath&quot; client &quot;prints the class path needed to get the Hadoop jar and the required libraries&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;conftest&quot; client &quot;validate configuration XML files&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;credential&quot; client &quot;interact with credential providers&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;daemonlog&quot; admin &quot;get/set the log level for each daemon&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;dtutil&quot; client &quot;operations related to delegation tokens&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;envvars&quot; client &quot;display computed Hadoop environment variables&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;fs&quot; client &quot;run a generic filesystem user client&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;jar &lt;jar&gt;&quot; client &quot;run a jar file. NOTE: please use \&quot;yarn jar\&quot; to launch YARN applications, not this command.&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;jnipath&quot; client &quot;prints the java.library.path&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;kerbname&quot; client &quot;show auth_to_local principal conversion&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;key&quot; client &quot;manage keys via the KeyProvider&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;trace&quot; client &quot;view and modify Hadoop tracing settings&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;version&quot; client &quot;print the version&quot;</span><br><span class="line">  hadoop_add_subcommand &quot;kdiag&quot; client &quot;Diagnose Kerberos Problems&quot;</span><br><span class="line">  hadoop_generate_usage &quot;$&#123;HADOOP_SHELL_EXECNAME&#125;&quot; true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">## @description  Default command handler for hadoop command</span><br><span class="line">## @audience     public</span><br><span class="line">## @stability    stable</span><br><span class="line">## @replaceable  no</span><br><span class="line">## @param        CLI arguments</span><br><span class="line">function hadoopcmd_case</span><br><span class="line">&#123;</span><br><span class="line">  subcmd=$1</span><br><span class="line">  shift</span><br><span class="line"></span><br><span class="line">  case $&#123;subcmd&#125; in</span><br><span class="line">    balancer|datanode|dfs|dfsadmin|dfsgroups|  \</span><br><span class="line">    namenode|secondarynamenode|fsck|fetchdt|oiv| \</span><br><span class="line">    portmap|nfs3)</span><br><span class="line">      hadoop_error &quot;WARNING: Use of this script to execute $&#123;subcmd&#125; is deprecated.&quot;</span><br><span class="line">      subcmd=$&#123;subcmd/dfsgroups/groups&#125;</span><br><span class="line">      hadoop_error &quot;WARNING: Attempting to execute replacement \&quot;hdfs $&#123;subcmd&#125;\&quot; instead.&quot;</span><br><span class="line">      hadoop_error &quot;&quot;</span><br><span class="line">      #try to locate hdfs and if present, delegate to it.</span><br><span class="line">      if [[ -f &quot;$&#123;HADOOP_HDFS_HOME&#125;/bin/hdfs&quot; ]]; then</span><br><span class="line">        exec &quot;$&#123;HADOOP_HDFS_HOME&#125;/bin/hdfs&quot; \</span><br><span class="line">          --config &quot;$&#123;HADOOP_CONF_DIR&#125;&quot; &quot;$&#123;subcmd&#125;&quot;  &quot;$@&quot;</span><br><span class="line">      elif [[ -f &quot;$&#123;HADOOP_HOME&#125;/bin/hdfs&quot; ]]; then</span><br><span class="line">        exec &quot;$&#123;HADOOP_HOME&#125;/bin/hdfs&quot; \</span><br><span class="line">          --config &quot;$&#123;HADOOP_CONF_DIR&#125;&quot; &quot;$&#123;subcmd&#125;&quot; &quot;$@&quot;</span><br><span class="line">      else</span><br><span class="line">        hadoop_error &quot;HADOOP_HDFS_HOME not found!&quot;</span><br><span class="line">        exit 1</span><br><span class="line">      fi</span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">    #mapred commands for backwards compatibility</span><br><span class="line">    pipes|job|queue|mrgroups|mradmin|jobtracker|tasktracker)</span><br><span class="line">      hadoop_error &quot;WARNING: Use of this script to execute $&#123;subcmd&#125; is deprecated.&quot;</span><br><span class="line">      subcmd=$&#123;subcmd/mrgroups/groups&#125;</span><br><span class="line">      hadoop_error &quot;WARNING: Attempting to execute replacement \&quot;mapred $&#123;subcmd&#125;\&quot; instead.&quot;</span><br><span class="line">      hadoop_error &quot;&quot;</span><br><span class="line">      #try to locate mapred and if present, delegate to it.</span><br><span class="line">      if [[ -f &quot;$&#123;HADOOP_MAPRED_HOME&#125;/bin/mapred&quot; ]]; then</span><br><span class="line">        exec &quot;$&#123;HADOOP_MAPRED_HOME&#125;/bin/mapred&quot; \</span><br><span class="line">        --config &quot;$&#123;HADOOP_CONF_DIR&#125;&quot; &quot;$&#123;subcmd&#125;&quot; &quot;$@&quot;</span><br><span class="line">      elif [[ -f &quot;$&#123;HADOOP_HOME&#125;/bin/mapred&quot; ]]; then</span><br><span class="line">        exec &quot;$&#123;HADOOP_HOME&#125;/bin/mapred&quot; \</span><br><span class="line">        --config &quot;$&#123;HADOOP_CONF_DIR&#125;&quot; &quot;$&#123;subcmd&#125;&quot; &quot;$@&quot;</span><br><span class="line">      else</span><br><span class="line">        hadoop_error &quot;HADOOP_MAPRED_HOME not found!&quot;</span><br><span class="line">        exit 1</span><br><span class="line">      fi</span><br><span class="line">    ;;</span><br><span class="line">    checknative)</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.util.NativeLibraryChecker</span><br><span class="line">    ;;</span><br><span class="line">    classpath)</span><br><span class="line">      hadoop_do_classpath_subcommand HADOOP_CLASSNAME &quot;$@&quot;</span><br><span class="line">    ;;</span><br><span class="line">    conftest)</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.util.ConfTest</span><br><span class="line">    ;;</span><br><span class="line">    credential)</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.security.alias.CredentialShell</span><br><span class="line">    ;;</span><br><span class="line">    daemonlog)</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.log.LogLevel</span><br><span class="line">    ;;</span><br><span class="line">    dtutil)</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.security.token.DtUtilShell</span><br><span class="line">    ;;</span><br><span class="line">    envvars)</span><br><span class="line">      echo &quot;JAVA_HOME=&#x27;$&#123;JAVA_HOME&#125;&#x27;&quot;</span><br><span class="line">      echo &quot;HADOOP_COMMON_HOME=&#x27;$&#123;HADOOP_COMMON_HOME&#125;&#x27;&quot;</span><br><span class="line">      echo &quot;HADOOP_COMMON_DIR=&#x27;$&#123;HADOOP_COMMON_DIR&#125;&#x27;&quot;</span><br><span class="line">      echo &quot;HADOOP_COMMON_LIB_JARS_DIR=&#x27;$&#123;HADOOP_COMMON_LIB_JARS_DIR&#125;&#x27;&quot;</span><br><span class="line">      echo &quot;HADOOP_COMMON_LIB_NATIVE_DIR=&#x27;$&#123;HADOOP_COMMON_LIB_NATIVE_DIR&#125;&#x27;&quot;</span><br><span class="line">      echo &quot;HADOOP_CONF_DIR=&#x27;$&#123;HADOOP_CONF_DIR&#125;&#x27;&quot;</span><br><span class="line">      echo &quot;HADOOP_TOOLS_HOME=&#x27;$&#123;HADOOP_TOOLS_HOME&#125;&#x27;&quot;</span><br><span class="line">      echo &quot;HADOOP_TOOLS_DIR=&#x27;$&#123;HADOOP_TOOLS_DIR&#125;&#x27;&quot;</span><br><span class="line">      echo &quot;HADOOP_TOOLS_LIB_JARS_DIR=&#x27;$&#123;HADOOP_TOOLS_LIB_JARS_DIR&#125;&#x27;&quot;</span><br><span class="line">      if [[ -n &quot;$&#123;QATESTMODE&#125;&quot; ]]; then</span><br><span class="line">        echo &quot;MYNAME=$&#123;MYNAME&#125;&quot;</span><br><span class="line">        echo &quot;HADOOP_SHELL_EXECNAME=$&#123;HADOOP_SHELL_EXECNAME&#125;&quot;</span><br><span class="line">      fi</span><br><span class="line">      exit 0</span><br><span class="line">    ;;</span><br><span class="line">    fs)</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.fs.FsShell</span><br><span class="line">    ;;</span><br><span class="line">    jar)</span><br><span class="line">      if [[ -n &quot;$&#123;YARN_OPTS&#125;&quot; ]] || [[ -n &quot;$&#123;YARN_CLIENT_OPTS&#125;&quot; ]]; then</span><br><span class="line">        hadoop_error &quot;WARNING: Use \&quot;yarn jar\&quot; to launch YARN applications.&quot;</span><br><span class="line">      fi</span><br><span class="line">      if [[ -z $1 || $1 = &quot;--help&quot; ]]; then</span><br><span class="line">        echo &quot;Usage: hadoop jar &lt;jar&gt; [mainClass] args...&quot;</span><br><span class="line">        exit 0</span><br><span class="line">      fi</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.util.RunJar</span><br><span class="line">    ;;</span><br><span class="line">    jnipath)</span><br><span class="line">      hadoop_finalize</span><br><span class="line">      echo &quot;$&#123;JAVA_LIBRARY_PATH&#125;&quot;</span><br><span class="line">      exit 0</span><br><span class="line">    ;;</span><br><span class="line">    kerbname)</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.security.HadoopKerberosName</span><br><span class="line">    ;;</span><br><span class="line">    kdiag)</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.security.KDiag</span><br><span class="line">    ;;</span><br><span class="line">    key)</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.crypto.key.KeyShell</span><br><span class="line">    ;;</span><br><span class="line">    trace)</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.tracing.TraceAdmin</span><br><span class="line">    ;;</span><br><span class="line">    version)</span><br><span class="line">      HADOOP_CLASSNAME=org.apache.hadoop.util.VersionInfo</span><br><span class="line">    ;;</span><br><span class="line">    *)</span><br><span class="line">      HADOOP_CLASSNAME=&quot;$&#123;subcmd&#125;&quot;</span><br><span class="line">      if ! hadoop_validate_classname &quot;$&#123;HADOOP_CLASSNAME&#125;&quot;; then</span><br><span class="line">        hadoop_exit_with_usage 1</span><br><span class="line">      fi</span><br><span class="line">    ;;</span><br><span class="line">  esac</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># This script runs the hadoop core commands.</span><br><span class="line"></span><br><span class="line"># let&#x27;s locate libexec...</span><br><span class="line">if [[ -n &quot;$&#123;HADOOP_HOME&#125;&quot; ]]; then</span><br><span class="line">  HADOOP_DEFAULT_LIBEXEC_DIR=&quot;$&#123;HADOOP_HOME&#125;/libexec&quot;</span><br><span class="line">else</span><br><span class="line">  bin=$(cd -P -- &quot;$(dirname -- &quot;$&#123;MYNAME&#125;&quot;)&quot; &gt;/dev/null &amp;&amp; pwd -P)</span><br><span class="line">  HADOOP_DEFAULT_LIBEXEC_DIR=&quot;$&#123;bin&#125;/../libexec&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">HADOOP_LIBEXEC_DIR=&quot;$&#123;HADOOP_LIBEXEC_DIR:-$HADOOP_DEFAULT_LIBEXEC_DIR&#125;&quot;</span><br><span class="line">HADOOP_NEW_CONFIG=true</span><br><span class="line">if [[ -f &quot;$&#123;HADOOP_LIBEXEC_DIR&#125;/hadoop-config.sh&quot; ]]; then</span><br><span class="line">  # shellcheck source=./hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.sh</span><br><span class="line">  . &quot;$&#123;HADOOP_LIBEXEC_DIR&#125;/hadoop-config.sh&quot;</span><br><span class="line">else</span><br><span class="line">  echo &quot;ERROR: Cannot execute $&#123;HADOOP_LIBEXEC_DIR&#125;/hadoop-config.sh.&quot; 2&gt;&amp;1</span><br><span class="line">  exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"># now that we have support code, let&#x27;s abs MYNAME so we can use it later</span><br><span class="line">MYNAME=$(hadoop_abs &quot;$&#123;MYNAME&#125;&quot;)</span><br><span class="line"></span><br><span class="line">if [[ $# = 0 ]]; then</span><br><span class="line">  hadoop_exit_with_usage 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">HADOOP_SUBCMD=$1</span><br><span class="line">shift</span><br><span class="line"></span><br><span class="line">if hadoop_need_reexec hadoop &quot;$&#123;HADOOP_SUBCMD&#125;&quot;; then</span><br><span class="line">  hadoop_uservar_su hadoop &quot;$&#123;HADOOP_SUBCMD&#125;&quot; \</span><br><span class="line">    &quot;$&#123;MYNAME&#125;&quot; \</span><br><span class="line">    &quot;--reexec&quot; \</span><br><span class="line">    &quot;$&#123;HADOOP_USER_PARAMS[@]&#125;&quot;</span><br><span class="line">  exit $?</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">hadoop_verify_user_perm &quot;$&#123;HADOOP_SHELL_EXECNAME&#125;&quot; &quot;$&#123;HADOOP_SUBCMD&#125;&quot;</span><br><span class="line"></span><br><span class="line">HADOOP_SUBCMD_ARGS=(&quot;$@&quot;)</span><br><span class="line"></span><br><span class="line">if declare -f hadoop_subcommand_&quot;$&#123;HADOOP_SUBCMD&#125;&quot; &gt;/dev/null 2&gt;&amp;1; then</span><br><span class="line">  hadoop_debug &quot;Calling dynamically: hadoop_subcommand_$&#123;HADOOP_SUBCMD&#125; $&#123;HADOOP_SUBCMD_ARGS[*]&#125;&quot;</span><br><span class="line">  &quot;hadoop_subcommand_$&#123;HADOOP_SUBCMD&#125;&quot; &quot;$&#123;HADOOP_SUBCMD_ARGS[@]&#125;&quot;</span><br><span class="line">else</span><br><span class="line">  hadoopcmd_case &quot;$&#123;HADOOP_SUBCMD&#125;&quot; &quot;$&#123;HADOOP_SUBCMD_ARGS[@]&#125;&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">hadoop_add_client_opts</span><br><span class="line"></span><br><span class="line">if [[ $&#123;HADOOP_WORKER_MODE&#125; = true ]]; then</span><br><span class="line">  hadoop_common_worker_mode_execute &quot;$&#123;HADOOP_COMMON_HOME&#125;/bin/hadoop&quot; &quot;$&#123;HADOOP_USER_PARAMS[@]&#125;&quot;</span><br><span class="line">  exit $?</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">hadoop_subcommand_opts &quot;$&#123;HADOOP_SHELL_EXECNAME&#125;&quot; &quot;$&#123;HADOOP_SUBCMD&#125;&quot;</span><br><span class="line"></span><br><span class="line"># everything is in globals at this point, so call the generic handler</span><br><span class="line">hadoop_generic_java_subcmd_handler</span><br></pre></td></tr></table></figure>

<br>
<br>
<br>
# 3.   编译和打包
[https://www.cnblogs.com/simplestupid/p/6444332.html](https://www.cnblogs.com/simplestupid/p/6444332.html)


<p>在ubuntu下使用ant编译和打包。参考sqoop的README，我安装的是jdk1.8.0_121和ant1.10.1。</p>
<p>&#x3D;&#x3D; Compiling Sqoop</p>
<p>Compiling Sqoop requires the following tools:</p>
<ul>
<li><p>Apache ant (1.7.1)</p>
</li>
<li><p>Java JDK 1.6</p>
</li>
</ul>
<p>Additionally, building the documentation requires these tools:</p>
<ul>
<li><p>asciidoc</p>
</li>
<li><p>make</p>
</li>
<li><p>python 2.5+</p>
</li>
<li><p>xmlto</p>
</li>
<li><p>tar</p>
</li>
<li><p>gzip</p>
</li>
</ul>
<p>To compile Sqoop, run <strong>ant package</strong>. There will be a fully self-hosted build</p>
<p>provided in the +build&#x2F;sqoop-(version)&#x2F;+ directory.</p>
<p>执行ant package命令即可。</p>
<p><img src="/Sqoop%E6%BA%90%E7%A0%81.assets%5C699ed5465cac4eb5bd0af5affb2c64c0.png" alt="brimage.png"></p>
<p>在build下得到构建产物。</p>
<p><img src="/Sqoop%E6%BA%90%E7%A0%81.assets%5C6a510fe341fd40f480b7b7a1e1e60691.png" alt="image.png"></p>
<p>BTW：这里我指定了hadoop版本是2.6.1，只要在build.xml中修改版本号即可。</p>
<p><img src="/Sqoop%E6%BA%90%E7%A0%81.assets%5C24116939664048a1865388000023517a.png" alt="image.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">CJ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2023/05/06/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%A6%BB%E7%BA%BF/Sqoop%E6%BA%90%E7%A0%81/">http://example.com/2023/05/06/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%A6%BB%E7%BA%BF/Sqoop%E6%BA%90%E7%A0%81/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Hexo</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/05/06/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%A6%BB%E7%BA%BF/Hive%E6%BA%90%E7%A0%81/" title="Hive源码"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Hive源码</div></div></a></div><div class="next-post pull-right"><a href="/2023/05/06/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%A6%BB%E7%BA%BF/Hive%E5%9F%BA%E7%A1%80/" title="Hive基础"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Hive基础</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">CJ</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">419</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">38</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BA%90%E7%A0%81%E6%A6%82%E8%A7%88"><span class="toc-number">1.</span> <span class="toc-text">一、源码概览</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BA%90%E7%A0%81%E4%BF%AE%E6%94%B9"><span class="toc-number">2.</span> <span class="toc-text">二、源码修改</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/05/06/MySQL/%E6%B3%A8%E8%A7%A3@Select%E5%92%8C@Insert/" title="注解@Select和@Insert">注解@Select和@Insert</a><time datetime="2023-05-06T05:48:28.906Z" title="发表于 2023-05-06 13:48:28">2023-05-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/05/06/%E5%90%8E%E7%AB%AF%E6%A1%86%E6%9E%B6/%E6%B3%A8%E8%A7%A3@EnableAutoConfiguration/" title="注解@EnableAutoConfiguration">注解@EnableAutoConfiguration</a><time datetime="2023-05-06T05:48:06.027Z" title="发表于 2023-05-06 13:48:06">2023-05-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/05/06/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%A6%BB%E7%BA%BF/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%9B%86%E7%BE%A4%E7%9B%91%E6%8E%A7%E6%A1%86%E6%9E%B6/" title="大数据集群监控框架">大数据集群监控框架</a><time datetime="2023-05-06T05:42:56.298Z" title="发表于 2023-05-06 13:42:56">2023-05-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/05/06/%E9%AB%98%E5%B9%B6%E5%8F%91/HashMap%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98%E5%8F%8AConcurrentHashMap%E5%8E%9F%E7%90%86/" title="HashMap并发问题及ConcurrentHashMap原理">HashMap并发问题及ConcurrentHashMap原理</a><time datetime="2023-05-06T05:31:21.103Z" title="发表于 2023-05-06 13:31:21">2023-05-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/05/06/%E9%AB%98%E5%B9%B6%E5%8F%91/Stream%E5%8E%9F%E7%90%86/" title="Stream原理">Stream原理</a><time datetime="2023-05-06T05:31:21.103Z" title="发表于 2023-05-06 13:31:21">2023-05-06</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By CJ</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>