---
title: Redo日志和Undo日志
categories:
- MySQL
---
# 一、事务ACID特性是如何实现的
事务的四种特性大家都知道是原子性、一致性、隔离性和持续性，也就是ACID,那么这四种特性是如何实现的呢？

- 隔离性由锁机制实现
- 剩下的三种特性由事务的redo和undo日志实现：
1.Redo Log是重做日志，可以再写入，恢复提交事务修改的数据页操作，来保证事务的持久性
2.Undo Log是回滚日志，回滚行记录到某个保存点，来保证事务的原子性和一致性。
>**redo log**：存储引擎层（innodb）生成的日志，记录的是物理层面的对数据页的操作，比如在某数据页某偏移量下写入或删除了某数据。
**undo log**：存储引擎层（innodb）生成的日志，记录的是逻辑层面的操作，且记录的都是相反的操作，比如对某行数据进行了insert操作，uodo日志中就会记载相反的操作delete，主要用于事务的回滚。

<br>
# 二、Redo日志和Undo日志
**Redo和Undo本质上都是一种恢复操作。**
Undo是把对数据表的操作回滚回去的行为，而Redo操作是比如对表数据进行了操作，但是没有刷新到磁盘上时，数据库宕机了，在数据库重启后，可以去Redo日志中找回这种操作的记录，继续执行。

## 1.1 Redo日志
### 1.1.1 原理
数据库的存储引擎（Innodb）是以数据页为单位来管理存储空间的，所有的数据都是放在磁盘中的。
加载一个数据页中的数据，需要先将这个数据页从磁盘缓存到内存中（放在Buffer Pool中）然后才可以访问。我们对数据库的增删改操作都是对内存中数据的修改，然后内存在将数据的变动以一定的频率刷新到磁盘上。
>为什么不直接修改磁盘中的数据，而是先将数据加载到内存中，在内存里修改，然后再更新到磁盘上？
**因为CPU更新内存中的数据比更新磁盘中的数据要快**

![image.png](Redo日志和Undo日志.assets