---
title: tf-keras
categories:
- 人工智能
---
###训练模型并预测结果的简单示例：
```csv
id,education,income
1,10,26.63
2,10.4,27.3
3,10.84,22.132
4,11.244,21.1698
5,11.645,15.1926
6,12.087,26.3989
7,12.488,17.435
8,12.889,25.508
9,13.29,36.884
10,13.732,39.6661
11,14.53,34.396
12,14.53511,41.497
13,14.976589,44.98
14,15.377926,47.0395
15,15.779264,48.252578
16,16.220736,57.034251
17,16.622074,51.490919
18,17.0234,61.336621
19,17.464883,57.581988
20,17.86621,68.551714
21,18.267559,64.310925
22,18.709,68.959
23,19.11,74.614
24,19.511706,71.867195
25,19.913,76.098
26,20.354515,75.775
27,20.755853,72.486
28,21.15719,77.355
29,21.59866,72.118
30,22,80.26
```

```py
# 导入数据
data = pd.read_csv("Income1.csv")
print(data)
# 点状图展示
plt.scatter(x=data.education, y=data.income)
plt.show()
# 创建模型
model = tf.keras.Sequential()  # 创建顺序模型
model.add(tf.keras.layers.Dense(1, input_shape=(1,)))
model.summary()  # 查看模型详情
model.compile(optimizer='adam', loss='mse')  # 设置优化方法(adam)和损失函数(均方差mse)
# 通过数据集训练模型
history = model.fit(data.education, data.income, epochs=5000)  # 设置横纵轴和训练次数
# 通过模型预测结果
pre_income = model.predict(pd.Series([20]).to_numpy())  # 根据education预测income
print(pre_income)
```


###梯度下降算法
梯度下降算法是致力于找到函数极值点的算法。所谓学习便是改进模型参数，以便通过大量训练步骤将损失最小化。将梯度下降算法应用于寻找损失函数的极值点便构成了依据输入数据的模型学习。

梯度的输出是一个由若干偏导数构成的向量，他的每个分量对应于函数对输入向量的相应分量的偏导。
![image.png](tf-keras.assetsbf1051412b4130869a5a262eace439.png)
梯度的输出向量表明了在函数的每个位置损失函数增长最快的方向，可将它视为表示了在函数的每个位置向哪个方向移动函数值可以增长。

adam是一种优化后的梯度下降算法。


###多层感知器（神经网络）
示例模型是单神经元的线性回归模型：
计算输入特征的加权和，然后使用一个激活函数（或传递函数）计算输出。
单层神经元的缺陷：无法拟合‘异或’运算，无法解决异或问题。
原因：神经元要求数据必须是线性可分的，异或问题无法找到一条直线分割两个类。这个问题使得神经网络的发展停滞了很多年。

![多层感知器](tf-keras.assets8f8d4246e9a46b19226af95e985cb00.png)
深度学习即有多层隐含层。
激活函数：可以使得神经网络拟合非线性的函数。
- ReLU线性整流函数是一种人工神经网络中常用的激活函数，当输入小于等于0时，输出为0，当输入大于0时，原样输出。![ReLU函数](tf-keras.assets\5379ca11fd9b40baba95017524f24839.png)
- Sigmoid函数因其单增以及反函数单增等性质，常被用作神经网络的激活函数，将输入范围限制在-1和1之间。![Sigmoid函数](tf-keras.assets73ae3b7877540b0b9e91fa338397f1e.png)
- tanh函数，由于其图形在定义域0附近近似线性，并且在整个定义域有可导性，该函数广泛用于深度学习领域的神经网络中作为神经元的激活函数使用。![tanh函数](tf-keras.assets\14113be884314ca19e789cb96b753152.png)
