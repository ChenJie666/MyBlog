---
title: Flink动态表的Join操作
categories:
- 大数据实时
---
## Left Join 测试
使用如下sql进行测试
```sql
INSERT INTO print_table 
SELECT sensorTable.id,productTable.id,productTable.name,sensorTable.temp 
FROM sensorTable 
LEFT JOIN productTable 
ON sensorTable.id = productTable.id
```
启动两个netcat分别进行输入，sensorTable为nc1、productTable为n2。

- **情况1：nc1先输入1条记录，nc2后输入两条记录**
   ①当nc1先输入 `[1,20,1676444725653]` 后，控制台直接输出 
   ```
   +I[1, null, null, 20]
   ```
   ②随后nc2输入 `[1,p1,1676444725653]` 后，控制台输出
   ```
   -D[1, null, null, 20]
   +I[1, 1, p1, 20]
   ```
   ③nc2再次输入 `[1,p2,1676444725653]` 后，控制台输出
   ```
   +I[1, 1, p2, 20]
   ```

- **情况2：nc1先输入2条记录，nc2后输入两条记录**
  ① 当nc1先输入 `[1,20,1676444725653]` 后，控制台直接输出 
   ```
   +I[1, null, null, 20]
   ```
   ②随后nc1再次输入 `[1,21,1676444725653]` 后，控制台直接输出
   ```
   +I[1, null, null, 21]
   ```
   ③nc2输入 `[1,p1,1676444725653]` 后，控制台输出
   ```
   -D[1, null, null, 20]
   -D[1, null, null, 21]
   +I[1, 1, p1, 20]
   +I[1, 1, p1, 21]
   ```
   ④nc2再次输入 `[1,p2,1676444725653]` 后，控制台输出
   ```
   +I[1, 1, p2, 20]
   +I[1, 1, p2, 21]
   ```

- **情况3：nc2先输入1条记录，nc1后输入2条记录**
   ①当nc2先输入 `[1,p1,1676444725653]` 后，控制台无输出
   ②随后nc1输入 `[1,20,1676444725653]` 后，控制台输出
   ```
   +I[1, 1, p1, 20]
   ```
   ③nc1再次输入 `[1,21,1676444725653]` 后，控制台输出
   ```
   +I[1, 1, p1, 21]
   ```

- **情况4：nc2先输入2条记录，nc1后输入2条记录**
   ①当nc2先输入 `[1,p1,1676444725653]` 后，控制台无输出
   ②nc2再次输入 `[1,p2,1676444725653]` 后，控制台无输出
   ③随后nc1输入 `[1,20,1676444725653]` 后，控制台输出
   ```
   +I[1, 1, p2, 20]
   +I[1, 1, p1, 20]
   ```
   ④nc1再次输入 `[1,21,1676444725653]` 后，控制台输出
   ```
   +I[1, 1, p2, 21]
   +I[1, 1, p1, 21]
   ```

- **情况5：将nc2替换为mysql，在mysql中输入1条记录，nc1输入一条记录，然后将mysql中记录删除**
   ①mysql输入 `[1,p1,1676444725653]` ，控制台无输出
   ②nc1输入 `[1,21,1676444725653]` 后，控制台输出
   ```
   +I[1, 1, p1, 20]
   ```
   ③mysql删除 `[1,p1,1676444725653]`，控制台输出
   ```
   -D[1, 1, p1, 20]
   +I[1, null, null, 20]
   ```

- **情况6：将nc2替换为mysql，在mysql中输入1条记录，nc1输入一条记录，然后将mysql中记录更新**
   ①mysql输入 `[1,p1,1676444725653]` ，控制台无输出
   ②nc1输入 `[1,21,1676444725653]` 后，控制台输出
   ```
   +I[1, 1, p1, 20]
   ```
   ③mysql更新 `[1,p1,1676444725653]` 为 `[1,p2,1676444725653]` ，控制台输出
   ```
   -U[1, 1, p1, 20]
   +I[1, null, null, 20]
   -D[1, null, null, 20]
   +I[1, 1, p2, 20]
   ```
   即更新操作分解为删除和插入两个操作。
